/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/floatSearchIndex.ts
var floatSearchIndex_exports = {};
__export(floatSearchIndex_exports, {
  default: () => FloatSearchPlugin
});
module.exports = __toCommonJS(floatSearchIndex_exports);
var import_obsidian2 = require("obsidian");

// src/leafView.ts
var import_obsidian = require("obsidian");
var popovers = /* @__PURE__ */ new WeakMap();
function isEmebeddedLeaf(leaf) {
  return leaf.containerEl.matches(".fs-block.fs-leaf-view .workspace-leaf");
}
function genId(size) {
  const chars = [];
  for (let n = 0; n < size; n++)
    chars.push((16 * Math.random() | 0).toString(16));
  return chars.join("");
}
function nosuper(base) {
  const derived = function() {
    return Object.setPrototypeOf(new import_obsidian.Component(), new.target.prototype);
  };
  derived.prototype = base.prototype;
  return Object.setPrototypeOf(derived, base);
}
var spawnLeafView = (plugin, initiatingEl, leaf, onShowCallback) => {
  let parent = app.workspace.activeLeaf;
  if (!parent)
    parent = leaf;
  if (!initiatingEl)
    initiatingEl = parent == null ? void 0 : parent.containerEl;
  const hoverPopover = new EmbeddedView(parent, initiatingEl, plugin, void 0, onShowCallback);
  return [hoverPopover.attachLeaf(), hoverPopover];
};
var _a, _b, _c, _d;
var EmbeddedView = class extends nosuper(import_obsidian.HoverPopover) {
  constructor(parent, targetEl, plugin, waitTime, onShowCallback) {
    super();
    this.targetEl = targetEl;
    this.plugin = plugin;
    this.onShowCallback = onShowCallback;
    this.abortController = this.addChild(new import_obsidian.Component());
    this.detaching = false;
    this.opening = false;
    this.rootSplit = new import_obsidian.WorkspaceSplit(window.app.workspace, "vertical");
    this.isPinned = true;
    this.oldPopover = (_a = this.parent) == null ? void 0 : _a.hoverPopover;
    this.document = (_d = (_c = (_b = this.targetEl) == null ? void 0 : _b.ownerDocument) != null ? _c : window.activeDocument) != null ? _d : window.document;
    this.id = genId(8);
    this.hoverEl = this.document.defaultView.createDiv({
      cls: "fs-block fs-leaf-view",
      attr: { id: "fs-" + this.id }
    });
    if (waitTime === void 0) {
      waitTime = 300;
    }
    this.onTarget = true;
    this.parent = parent;
    this.waitTime = waitTime;
    this.state = import_obsidian.PopoverState.Showing;
    const { hoverEl } = this;
    this.abortController.load();
    this.show();
    this.onShow();
    this.setActive = this._setActive.bind(this);
    popovers.set(this.hoverEl, this);
    this.hoverEl.addClass("fs-block");
    this.containerEl = this.hoverEl.createDiv("fs-content");
    this.buildWindowControls();
    this.setInitialDimensions();
  }
  static activeWindows() {
    const windows = [window];
    const { floatingSplit } = app.workspace;
    if (floatingSplit) {
      for (const split of floatingSplit.children) {
        if (split.win)
          windows.push(split.win);
      }
    }
    return windows;
  }
  static containerForDocument(doc) {
    if (doc !== document && app.workspace.floatingSplit)
      for (const container of app.workspace.floatingSplit.children) {
        if (container.doc === doc)
          return container;
      }
    return app.workspace.rootSplit;
  }
  static activePopovers() {
    return this.activeWindows().flatMap(this.popoversForWindow);
  }
  static popoversForWindow(win) {
    var _a2, _b2;
    return Array.prototype.slice.call((_b2 = (_a2 = win == null ? void 0 : win.document) == null ? void 0 : _a2.body.querySelectorAll(".fs-leaf-view")) != null ? _b2 : []).map((el) => popovers.get(el)).filter((he) => he);
  }
  static forLeaf(leaf) {
    const el = leaf && document.body.matchParent.call(leaf.containerEl, ".fs-leaf-view");
    return el ? popovers.get(el) : void 0;
  }
  static iteratePopoverLeaves(ws, cb) {
    for (const popover of this.activePopovers()) {
      if (popover.rootSplit && ws.iterateLeaves(cb, popover.rootSplit))
        return true;
    }
    return false;
  }
  _setActive(evt) {
    evt.preventDefault();
    evt.stopPropagation();
    this.plugin.app.workspace.setActiveLeaf(this.leaves()[0], { focus: true });
  }
  getDefaultMode() {
    return "source";
  }
  updateLeaves() {
    if (this.onTarget && this.targetEl && !this.document.contains(this.targetEl)) {
      this.onTarget = false;
      this.transition();
    }
    let leafCount = 0;
    this.plugin.app.workspace.iterateLeaves((leaf) => {
      leafCount++;
    }, this.rootSplit);
    if (leafCount === 0) {
      this.hide();
    }
    this.hoverEl.setAttribute("data-leaf-count", leafCount.toString());
  }
  leaves() {
    const leaves = [];
    this.plugin.app.workspace.iterateLeaves((leaf) => {
      leaves.push(leaf);
    }, this.rootSplit);
    return leaves;
  }
  setInitialDimensions() {
    this.hoverEl.style.height = "auto";
    this.hoverEl.style.width = "100%";
  }
  transition() {
    if (this.shouldShow()) {
      if (this.state === import_obsidian.PopoverState.Hiding) {
        this.state = import_obsidian.PopoverState.Shown;
        clearTimeout(this.timer);
      }
    } else {
      if (this.state === import_obsidian.PopoverState.Showing) {
        this.hide();
      } else {
        if (this.state === import_obsidian.PopoverState.Shown) {
          this.state = import_obsidian.PopoverState.Hiding;
          this.timer = window.setTimeout(() => {
            if (this.shouldShow()) {
              this.transition();
            } else {
              this.hide();
            }
          }, this.waitTime);
        }
      }
    }
  }
  buildWindowControls() {
    this.titleEl = this.document.defaultView.createDiv("popover-titlebar");
    this.titleEl.createDiv("popover-title");
    this.containerEl.prepend(this.titleEl);
  }
  attachLeaf() {
    this.rootSplit.getRoot = () => this.plugin.app.workspace[this.document === document ? "rootSplit" : "floatingSplit"];
    this.rootSplit.getContainer = () => EmbeddedView.containerForDocument(this.document);
    this.titleEl.insertAdjacentElement("afterend", this.rootSplit.containerEl);
    const leaf = this.plugin.app.workspace.createLeafInParent(this.rootSplit, 0);
    this.updateLeaves();
    return leaf;
  }
  onload() {
    super.onload();
    this.registerEvent(this.plugin.app.workspace.on("layout-change", this.updateLeaves, this));
    this.registerEvent(app.workspace.on("layout-change", () => {
      this.rootSplit.children.forEach((item, index) => {
        if (item instanceof import_obsidian.WorkspaceTabs) {
          this.rootSplit.replaceChild(index, item.children[0]);
        }
      });
    }));
  }
  onShow() {
    var _a2, _b2;
    const closeDelay = 600;
    setTimeout(() => this.waitTime = closeDelay, closeDelay);
    (_a2 = this.oldPopover) == null ? void 0 : _a2.hide();
    this.oldPopover = null;
    this.hoverEl.toggleClass("is-new", true);
    this.document.body.addEventListener("click", () => {
      this.hoverEl.toggleClass("is-new", false);
    }, { once: true, capture: true });
    if (this.parent) {
      this.parent.hoverPopover = this;
    }
    const viewHeaderEl = this.hoverEl.querySelector(".view-header");
    viewHeaderEl == null ? void 0 : viewHeaderEl.remove();
    const sizer = this.hoverEl.querySelector(".workspace-leaf");
    if (sizer)
      this.hoverEl.appendChild(sizer);
    const inlineTitle = this.hoverEl.querySelector(".inline-title");
    if (inlineTitle)
      inlineTitle.remove();
    (_b2 = this.onShowCallback) == null ? void 0 : _b2.call(this);
    this.onShowCallback = void 0;
  }
  detect(el) {
    const { targetEl } = this;
    if (targetEl) {
      this.onTarget = el === targetEl || targetEl.contains(el);
    }
  }
  shouldShow() {
    return this.shouldShowSelf() || this.shouldShowChild();
  }
  shouldShowChild() {
    return EmbeddedView.activePopovers().some((popover) => {
      if (popover !== this && popover.targetEl && this.hoverEl.contains(popover.targetEl)) {
        return popover.shouldShow();
      }
      return false;
    });
  }
  shouldShowSelf() {
    return !this.detaching && !!(this.onTarget || this.state == import_obsidian.PopoverState.Shown || this.document.querySelector(`body>.modal-container, body > #he${this.id} ~ .menu, body > #he${this.id} ~ .suggestion-container`));
  }
  show() {
    this.state = import_obsidian.PopoverState.Shown;
    this.timer = 0;
    this.targetEl.appendChild(this.hoverEl);
    this.onShow();
    app.workspace.onLayoutChange();
    this.load();
    if (this.hoverEl.dataset.imgHeight && this.hoverEl.dataset.imgWidth) {
      this.hoverEl.style.height = parseFloat(this.hoverEl.dataset.imgHeight) + this.titleEl.offsetHeight + "px";
      this.hoverEl.style.width = parseFloat(this.hoverEl.dataset.imgWidth) + "px";
    }
  }
  onHide() {
    var _a2;
    this.oldPopover = null;
    if (((_a2 = this.parent) == null ? void 0 : _a2.hoverPopover) === this) {
      this.parent.hoverPopover = null;
    }
  }
  hide() {
    var _a2;
    this.onTarget = false;
    this.detaching = true;
    if (this.timer) {
      clearTimeout(this.timer);
      this.timer = 0;
    }
    this.hoverEl.hide();
    if (this.opening)
      return;
    const leaves = this.leaves();
    if (leaves.length) {
      this.targetEl.empty();
    } else {
      this.parent = null;
      (_a2 = this.abortController) == null ? void 0 : _a2.unload();
      this.abortController = void 0;
      return this.nativeHide();
    }
  }
  nativeHide() {
    var _a2;
    const { hoverEl, targetEl } = this;
    this.state = import_obsidian.PopoverState.Hidden;
    hoverEl.detach();
    if (targetEl) {
      const parent = targetEl.matchParent(".fs-leaf-view");
      if (parent)
        (_a2 = popovers.get(parent)) == null ? void 0 : _a2.transition();
    }
    this.onHide();
    this.unload();
  }
  resolveLink(linkText, sourcePath) {
    const link = (0, import_obsidian.parseLinktext)(linkText);
    const tFile = link ? this.plugin.app.metadataCache.getFirstLinkpathDest(link.path, sourcePath) : null;
    return tFile;
  }
  async openLink(linkText, sourcePath, eState, createInLeaf) {
    var _a2, _b2, _c2;
    let file = this.resolveLink(linkText, sourcePath);
    const link = (0, import_obsidian.parseLinktext)(linkText);
    if (!file && createInLeaf) {
      const folder = this.plugin.app.fileManager.getNewFileParent(sourcePath);
      file = await this.plugin.app.fileManager.createNewMarkdownFile(folder, link.path);
    }
    if (!file) {
      return;
    }
    const { viewRegistry } = this.plugin.app;
    const viewType = viewRegistry.typeByExtension[file.extension];
    if (!viewType || !viewRegistry.viewByType[viewType]) {
      return;
    }
    eState = Object.assign(this.buildEphemeralState(file, link), eState);
    const parentMode = this.getDefaultMode();
    const state = this.buildState(parentMode, eState);
    const leaf = await this.openFile(file, state, createInLeaf);
    const leafViewType = (_a2 = leaf == null ? void 0 : leaf.view) == null ? void 0 : _a2.getViewType();
    if (leafViewType === "image") {
      if (((_b2 = this.parent) == null ? void 0 : _b2.hasOwnProperty("editorEl")) && this.parent.editorEl.hasClass("is-live-preview")) {
        this.waitTime = 3e3;
      }
      const img = leaf.view.contentEl.querySelector("img");
      this.hoverEl.dataset.imgHeight = String(img.naturalHeight);
      this.hoverEl.dataset.imgWidth = String(img.naturalWidth);
      this.hoverEl.dataset.imgRatio = String(img.naturalWidth / img.naturalHeight);
    } else if (leafViewType === "pdf") {
      this.hoverEl.style.height = "800px";
      this.hoverEl.style.width = "600px";
    }
    if (((_c2 = state.state) == null ? void 0 : _c2.mode) === "source") {
      this.whenShown(() => {
        var _a3, _b3, _c3, _d2;
        if ((0, import_obsidian.requireApiVersion)("1.0"))
          (_c3 = (_b3 = (_a3 = leaf == null ? void 0 : leaf.view) == null ? void 0 : _a3.editMode) == null ? void 0 : _b3.reinit) == null ? void 0 : _c3.call(_b3);
        (_d2 = leaf == null ? void 0 : leaf.view) == null ? void 0 : _d2.setEphemeralState(state.eState);
      });
    }
  }
  whenShown(callback) {
    if (this.detaching)
      return;
    const existingCallback = this.onShowCallback;
    this.onShowCallback = () => {
      if (this.detaching)
        return;
      callback();
      if (typeof existingCallback === "function")
        existingCallback();
    };
    if (this.state === import_obsidian.PopoverState.Shown) {
      this.onShowCallback();
      this.onShowCallback = void 0;
    }
  }
  async openFile(file, openState, useLeaf) {
    if (this.detaching)
      return;
    const leaf = useLeaf != null ? useLeaf : this.attachLeaf();
    this.opening = true;
    try {
      await leaf.openFile(file, openState);
    } catch (e) {
      console.error(e);
    } finally {
      this.opening = false;
      if (this.detaching)
        this.hide();
    }
    this.plugin.app.workspace.setActiveLeaf(leaf);
    return leaf;
  }
  buildState(parentMode, eState) {
    return {
      active: false,
      state: { mode: "source" },
      eState
    };
  }
  buildEphemeralState(file, link) {
    const cache = this.plugin.app.metadataCache.getFileCache(file);
    const subpath = cache ? (0, import_obsidian.resolveSubpath)(cache, (link == null ? void 0 : link.subpath) || "") : void 0;
    const eState = { subpath: link == null ? void 0 : link.subpath };
    if (subpath) {
      eState.line = subpath.start.line;
      eState.startLoc = subpath.start;
      eState.endLoc = subpath.end || void 0;
    }
    return eState;
  }
};

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/floatSearchIndex.ts
var FloatSearchPlugin = class extends import_obsidian2.Plugin {
  constructor() {
    super(...arguments);
    this.applyDebounceTimer = 0;
  }
  applySettingsUpdate() {
    clearTimeout(this.applyDebounceTimer);
    this.applyDebounceTimer = window.setTimeout(() => {
      this.state = {
        ...this.state,
        query: ""
      };
    }, 3e4);
  }
  async onload() {
    this.patchWorkspace();
    this.patchWorkspaceLeaf();
    this.registerObsidianURIHandler();
    this.registerObsidianCommands();
    this.registerEditorMenuHandler();
    this.registerContextMenuHandler();
    this.addRibbonIcon("search", "Search Obsidian In Modal", () => {
      this.modal = new FloatSearchModal((state) => {
        this.state = state;
        this.applySettingsUpdate();
      }, this.app, this, this.state);
      this.modal.open();
    });
  }
  onunload() {
    this.state = void 0;
  }
  patchWorkspace() {
    let layoutChanging = false;
    const uninstaller = around(import_obsidian2.Workspace.prototype, {
      getLeaf: (next) => function(...args) {
        const activeLeaf = this.activeLeaf;
        if (activeLeaf) {
          const fsCtnEl = activeLeaf.parent.containerEl.parentElement;
          if (fsCtnEl == null ? void 0 : fsCtnEl.classList.contains("fs-content")) {
            if (activeLeaf.view.getViewType() === "markdown") {
              return activeLeaf;
            }
            const newLeaf = app.workspace.getUnpinnedLeaf();
            if (newLeaf) {
              this.setActiveLeaf(newLeaf);
            }
          }
          return next.call(this, ...args);
        }
        return next.call(this, ...args);
      },
      changeLayout(old) {
        return async function(workspace) {
          layoutChanging = true;
          try {
            await old.call(this, workspace);
          } finally {
            layoutChanging = false;
          }
        };
      },
      iterateLeaves(old) {
        return function(arg1, arg2) {
          if (old.call(this, arg1, arg2))
            return true;
          const cb = typeof arg1 === "function" ? arg1 : arg2;
          const parent = typeof arg1 === "function" ? arg2 : arg1;
          if (!parent)
            return false;
          if (layoutChanging)
            return false;
          if (parent === app.workspace.rootSplit || import_obsidian2.WorkspaceContainer && parent instanceof import_obsidian2.WorkspaceContainer) {
            for (const popover of EmbeddedView.popoversForWindow(parent.win)) {
              if (old.call(this, cb, popover.rootSplit))
                return true;
            }
          }
          return false;
        };
      },
      onDragLeaf(old) {
        return function(event, leaf) {
          return old.call(this, event, leaf);
        };
      }
    });
    this.register(uninstaller);
  }
  patchWorkspaceLeaf() {
    this.register(around(import_obsidian2.WorkspaceLeaf.prototype, {
      getRoot(old) {
        return function() {
          const top = old.call(this);
          return (top == null ? void 0 : top.getRoot) === this.getRoot ? top : top == null ? void 0 : top.getRoot();
        };
      },
      setPinned(old) {
        return function(pinned) {
          old.call(this, pinned);
          if (isEmebeddedLeaf(this) && !pinned)
            this.setPinned(true);
        };
      },
      openFile(old) {
        return function(file, openState) {
          if (isEmebeddedLeaf(this)) {
            setTimeout(around(import_obsidian2.Workspace.prototype, {
              recordMostRecentOpenedFile(old2) {
                return function(_file) {
                  if (_file !== file) {
                    return old2.call(this, _file);
                  }
                };
              }
            }), 1);
            const recentFiles = this.app.plugins.plugins["recent-files-obsidian"];
            if (recentFiles) {
              setTimeout(around(recentFiles, {
                shouldAddFile(old2) {
                  return function(_file) {
                    return _file !== file && old2.call(this, _file);
                  };
                }
              }), 1);
            }
          }
          const view = old.call(this, file, openState);
          setTimeout(() => {
            const fsCtnEl = this.parent.containerEl.parentElement;
            if (!(fsCtnEl == null ? void 0 : fsCtnEl.classList.contains("fs-content")))
              return;
            if (file.extension != "canvas")
              return;
            const canvas = this.view.canvas;
            setTimeout(() => {
              var _a2, _b2;
              if (canvas && ((_a2 = openState == null ? void 0 : openState.eState) == null ? void 0 : _a2.match)) {
                let node = (_b2 = canvas.data.nodes) == null ? void 0 : _b2.find((e) => e.text === openState.eState.match.content);
                node = canvas.nodes.get(node.id);
                canvas.selectOnly(node);
                canvas.zoomToSelection();
              }
            }, 20);
          }, 1);
          return view;
        };
      }
    }));
  }
  registerObsidianURIHandler() {
    this.registerObsidianProtocolHandler("fs", (path) => {
      this.modal = new FloatSearchModal((state) => {
        this.state = state;
        this.applySettingsUpdate();
      }, this.app, this, { query: path.query, current: false });
      this.modal.open();
    });
  }
  registerObsidianCommands() {
    this.addCommand({
      id: "search-obsidian-globally",
      name: "Search Obsidian Globally",
      callback: () => {
        this.modal = new FloatSearchModal((state) => {
          this.state = state;
        }, this.app, this, { ...this.state, query: "", current: false });
        this.modal.open();
      }
    });
    this.addCommand({
      id: "search-obsidian-globally-state",
      name: "Search Obsidian Globally (With Last State)",
      callback: () => {
        this.modal = new FloatSearchModal((state) => {
          this.state = state;
        }, this.app, this, { ...this.state, current: false });
        this.modal.open();
      }
    });
    this.addCommand({
      id: "search-in-backlink",
      name: "Search In Backlink Of Current File",
      checkCallback: (checking) => {
        const activeLeaf = this.app.workspace.activeLeaf;
        if (!activeLeaf)
          return;
        const viewType = activeLeaf.view.getViewType();
        if (viewType === "markdown" || viewType === "canvas") {
          if (!checking) {
            const currentFile = activeLeaf.view.file;
            this.modal = new FloatSearchModal((state) => {
              this.state = state;
              this.applySettingsUpdate();
            }, this.app, this, { ...this.state, query: " /\\[\\[" + (currentFile.extension === "canvas" ? currentFile.name : currentFile.basename) + "(\\|[^\\]]*)?\\]\\]/", current: true });
            this.modal.open();
          }
          return true;
        }
      }
    });
    this.addCommand({
      id: "search-in-current-file",
      name: "Search In Current File",
      checkCallback: (checking) => {
        const activeLeaf = this.app.workspace.activeLeaf;
        if (!activeLeaf)
          return;
        const viewType = activeLeaf.view.getViewType();
        if (viewType === "markdown" || viewType === "canvas") {
          if (!checking) {
            const currentFile = activeLeaf.view.file;
            this.modal = new FloatSearchModal((state) => {
              this.state = state;
              this.applySettingsUpdate();
            }, this.app, this, { ...this.state, query: " path:" + currentFile.path, current: true });
            this.modal.open();
          }
          return true;
        }
      }
    });
    this.addCommand({
      id: "open-search-view",
      name: "Open Search View",
      callback: async () => {
        const leaf = app.workspace.getLeaf();
        leaf.setPinned(true);
        await leaf.setViewState({
          type: "search"
        });
      }
    });
    this.addCommand({
      id: "open-search-view-window",
      name: "Open Search View Window",
      callback: async () => {
        const leaf = app.workspace.getLeaf("window");
        leaf.setPinned(true);
        await leaf.setViewState({
          type: "search"
        });
      }
    });
  }
  registerEditorMenuHandler() {
    this.registerEvent(this.app.workspace.on("editor-menu", (menu, editor, view) => {
      if (!editor) {
        return;
      }
      if (editor.getSelection().length === 0) {
        return;
      }
      const selection = editor.getSelection().trim();
      let searchWord = selection;
      if (selection.length > 8) {
        searchWord = selection.substring(0, 3) + "..." + selection.substring(selection.length - 3, selection.length);
      } else {
        searchWord = selection;
      }
      menu.addItem((item) => {
        item.setTitle('Search "' + searchWord + '" in Float Search').setIcon("search").onClick(() => {
          this.modal = new FloatSearchModal((state) => {
            this.state = state;
            this.applySettingsUpdate();
          }, this.app, this, { query: selection, current: false });
          this.modal.open();
        });
      });
    }));
  }
  registerContextMenuHandler() {
    this.registerEvent(this.app.workspace.on("file-menu", (menu, file, source, leaf) => {
      const popover = leaf ? EmbeddedView.forLeaf(leaf) : void 0;
      if (file instanceof import_obsidian2.TFile && !popover && !leaf) {
        menu.addItem((item) => {
          var _a2, _b2;
          (_b2 = (_a2 = item.setIcon("popup-open").setTitle("Open in Float Preview").onClick(async () => {
            if (this.modal) {
              await this.modal.initFileView(file, void 0);
              return;
            }
            this.modal = new FloatSearchModal((state) => {
              this.state = state;
              this.applySettingsUpdate();
            }, this.app, this, { query: "", current: false });
            this.modal.open();
            setTimeout(async () => {
              await this.modal.initFileView(file, void 0);
            }, 20);
          })).setSection) == null ? void 0 : _b2.call(_a2, "open");
        });
      }
    }));
  }
};
var FloatSearchModal = class extends import_obsidian2.Modal {
  constructor(cb, app2, plugin, state, viewType = "search") {
    super(app2);
    this.plugin = plugin;
    this.cb = cb;
    this.state = state;
    this.viewType = viewType;
  }
  async onOpen() {
    const { contentEl, containerEl, modalEl } = this;
    this.searchCtnEl = contentEl.createDiv({ cls: "float-search-modal-search-ctn" });
    this.instructionsEl = modalEl.createDiv({ cls: "float-search-modal-instructions" });
    this.initInstructions(this.instructionsEl);
    this.initCss(contentEl, modalEl, containerEl);
    await this.initSearchView(this.searchCtnEl, this.viewType);
    this.initInput();
    this.initContent();
  }
  onClose() {
    var _a2, _b2;
    const { contentEl } = this;
    this.cb(this.searchLeaf.view.getState());
    this.searchLeaf.detach();
    (_a2 = this.fileLeaf) == null ? void 0 : _a2.detach();
    this.searchEmbeddedView.unload();
    (_b2 = this.fileEmbeddedView) == null ? void 0 : _b2.unload();
    contentEl.empty();
  }
  initInstructions(instructionsEl) {
    const navigateInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-navigate" });
    const collapseInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-collapse" });
    const enterInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-enter" });
    const altEnterInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-alt-enter" });
    const tabInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-tab" });
    const switchInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-switch" });
    const navigateIconEl = navigateInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const navigateTextEl = navigateInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    navigateIconEl.setText("\u2191\u2193");
    navigateTextEl.setText("Navigate");
    const collapseIconEl = collapseInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const collapseTextEl = collapseInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    collapseIconEl.setText("Shift+\u2191\u2193");
    collapseTextEl.setText("Collapse/Expand");
    const enterIconEl = enterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const enterTextEl = enterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    enterIconEl.setText("\u21B5");
    enterTextEl.setText("Open in background");
    const altEnterIconEl = altEnterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const altEnterTextEl = altEnterInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    altEnterIconEl.setText("Alt+\u21B5");
    altEnterTextEl.setText("Open File and Close");
    const tabIconEl = tabInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const tabTextEl = tabInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    tabIconEl.setText("Tab/Shift+Tab");
    tabTextEl.setText("Preview/Close Preview");
    const switchIconEl = switchInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const switchTextEl = switchInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    switchIconEl.setText("Ctrl+G");
    switchTextEl.setText("Switch Between Search and File View");
    const clickInstructionsEl = instructionsEl.createDiv({ cls: "float-search-modal-instructions-click" });
    const clickIconEl = clickInstructionsEl.createSpan({ cls: "float-search-modal-instructions-key" });
    const clickTextEl = clickInstructionsEl.createSpan({ cls: "float-search-modal-instructions-text" });
    clickIconEl.setText("Alt+Click");
    clickTextEl.setText("Close Modal While In File View");
  }
  initCss(contentEl, modalEl, containerEl) {
    contentEl.classList.add("float-search-modal-content");
    modalEl.classList.add("float-search-modal");
    containerEl.classList.add("float-search-modal-container");
  }
  async initSearchView(contentEl, viewType) {
    const [createdLeaf, embeddedView] = spawnLeafView(this.plugin, contentEl);
    this.searchLeaf = createdLeaf;
    this.searchEmbeddedView = embeddedView;
    this.searchLeaf.setPinned(true);
    await this.searchLeaf.setViewState({
      type: "search"
    });
    setTimeout(async () => {
      var _a2, _b2, _c2;
      await this.searchLeaf.view.setState(this.state, true);
      ((_a2 = this.state) == null ? void 0 : _a2.current) ? this.searchLeaf.view.searchComponent.inputEl.setSelectionRange(0, 0) : this.searchLeaf.view.searchComponent.inputEl.setSelectionRange(0, (_c2 = (_b2 = this.state) == null ? void 0 : _b2.query) == null ? void 0 : _c2.length);
    }, 0);
    return;
  }
  initInput() {
    const inputEl = this.contentEl.getElementsByTagName("input")[0];
    inputEl.focus();
    inputEl.onkeydown = (e) => {
      var _a2, _b2;
      const currentView = this.searchLeaf.view;
      switch (e.key) {
        case "ArrowDown":
          if (e.shiftKey) {
            currentView.onKeyShowMoreAfter(e);
            if (currentView.dom.focusedItem) {
              if (currentView.dom.focusedItem.collapsible) {
                currentView.dom.focusedItem.setCollapse(false);
              }
            }
            break;
          } else {
            currentView.onKeyArrowDownInFocus(e);
            break;
          }
        case "ArrowUp":
          if (e.shiftKey) {
            currentView.onKeyShowMoreBefore(e);
            if (currentView.dom.focusedItem) {
              if (currentView.dom.focusedItem.collapseEl) {
                currentView.dom.focusedItem.setCollapse(true);
              }
            }
            break;
          } else {
            currentView.onKeyArrowUpInFocus(e);
            break;
          }
        case "ArrowLeft":
          currentView.onKeyArrowLeftInFocus(e);
          break;
        case "ArrowRight":
          currentView.onKeyArrowRightInFocus(e);
          break;
        case "Enter":
          currentView.onKeyEnterInFocus(e);
          if (e.altKey && currentView.dom.focusedItem) {
            this.close();
          }
          break;
        case "Tab":
          e.preventDefault();
          if (e.shiftKey) {
            if (this.fileLeaf) {
              (_a2 = this.fileLeaf) == null ? void 0 : _a2.detach();
              this.fileLeaf = void 0;
              (_b2 = this.fileEmbeddedView) == null ? void 0 : _b2.unload();
              this.modalEl.toggleClass("float-search-width", false);
              this.fileEl.detach();
              break;
            }
          }
          if (currentView.dom.focusedItem) {
            const item = currentView.dom.focusedItem;
            const file = item.parent.file instanceof import_obsidian2.TFile ? item.parent.file : item.file;
            item.parent.file instanceof import_obsidian2.TFile ? this.initFileView(file, { match: {
              content: item.content,
              matches: item.matches
            } }) : this.initFileView(file, void 0);
          }
          break;
        case "e":
          if (e.ctrlKey) {
            e.preventDefault();
            if (this.fileLeaf) {
              const estate = this.fileLeaf.getViewState();
              estate.state.mode = estate.state.mode === "preview" ? "source" : "preview";
              this.fileLeaf.setViewState(estate, {
                focus: true
              });
              setTimeout(() => {
                this.searchLeaf.view.searchComponent.inputEl.focus();
              }, 0);
            }
            break;
          }
        case "g":
          if (this.fileLeaf && e.ctrlKey) {
            e.preventDefault();
            app.workspace.setActiveLeaf(this.fileLeaf, {
              focus: true
            });
          }
          break;
        case "C":
          if (e.ctrlKey && e.shiftKey) {
            e.preventDefault();
            const text = currentView.dom.focusedItem.el.innerText;
            navigator.clipboard.writeText(text);
          }
      }
    };
  }
  initContent() {
    const { contentEl } = this;
    contentEl.onclick = (e) => {
      const resultElement = contentEl.getElementsByClassName("search-results-children")[0];
      if (resultElement.children.length < 2) {
        return;
      }
      let targetElement = e.target;
      if (e.altKey || !this.fileLeaf) {
        while (targetElement) {
          if (targetElement.classList.contains("tree-item-icon")) {
            break;
          }
          if (targetElement.classList.contains("tree-item")) {
            this.close();
            break;
          }
          targetElement = targetElement.parentElement;
        }
        return;
      }
      if (this.fileLeaf) {
        const currentView = this.searchLeaf.view;
        if (this.searchCtnEl.contains(targetElement)) {
          while (targetElement) {
            if (targetElement.classList.contains("tree-item")) {
              break;
            }
            targetElement = targetElement.parentElement;
          }
          if (!targetElement)
            return;
          const fileInnerEl = targetElement == null ? void 0 : targetElement.getElementsByClassName("tree-item-inner")[0];
          const innerText = fileInnerEl.innerText;
          const file = app.metadataCache.getFirstLinkpathDest(innerText, "");
          if (file) {
            const item = currentView.dom.resultDomLookup.get(file);
            currentView.dom.setFocusedItem(item);
            this.initFileView(file, void 0);
            this.searchLeaf.view.searchComponent.inputEl.focus();
          }
        }
        return;
      }
    };
  }
  async initFileView(file, state) {
    var _a2, _b2, _c2;
    if (this.fileLeaf) {
      await this.fileLeaf.openFile(file, {
        active: false,
        eState: state
      });
      if (((_b2 = (_a2 = this.fileState) == null ? void 0 : _a2.match) == null ? void 0 : _b2.matches[0]) === ((_c2 = state == null ? void 0 : state.match) == null ? void 0 : _c2.matches[0]) && state && this.fileState) {
        setTimeout(() => {
          if (this.fileLeaf) {
            app.workspace.setActiveLeaf(this.fileLeaf, {
              focus: true
            });
          }
        }, 0);
      } else {
        this.fileState = state;
        setTimeout(() => {
          this.searchLeaf.view.searchComponent.inputEl.focus();
        }, 0);
      }
      return;
    }
    const { contentEl } = this;
    this.fileEl = contentEl.createDiv({ cls: "float-search-modal-file-ctn" });
    this.modalEl.toggleClass("float-search-width", true);
    this.fileEl.onkeydown = (e) => {
      if (e.ctrlKey && e.key === "g") {
        e.preventDefault();
        e.stopPropagation();
        this.searchLeaf.view.searchComponent.inputEl.focus();
      }
      if (e.key === "Tab" && e.ctrlKey) {
        e.preventDefault();
        e.stopPropagation();
        this.searchLeaf.view.searchComponent.inputEl.focus();
      }
    };
    if (!this.fileEl)
      return;
    const [createdLeaf, embeddedView] = spawnLeafView(this.plugin, this.fileEl);
    this.fileLeaf = createdLeaf;
    this.fileEmbeddedView = embeddedView;
    this.fileLeaf.setPinned(true);
    await this.fileLeaf.openFile(file, {
      active: false,
      eState: state
    });
    this.fileState = state;
    this.searchLeaf.view.searchComponent.inputEl.focus();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL2Zsb2F0U2VhcmNoSW5kZXgudHMiLCAic3JjL2xlYWZWaWV3LnRzIiwgIm5vZGVfbW9kdWxlcy9tb25rZXktYXJvdW5kL21qcy9pbmRleC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcclxuXHRhcGlWZXJzaW9uLFxyXG5cdEFwcCxcclxuXHRFZGl0b3IsXHJcblx0TWFya2Rvd25WaWV3LFxyXG5cdE1lbnUsXHJcblx0TW9kYWwsIE5vdGljZSwgT3BlblZpZXdTdGF0ZSxcclxuXHRQbHVnaW4sIHJlcXVpcmVBcGlWZXJzaW9uLCBTZWFyY2hWaWV3LFxyXG5cdFRBYnN0cmFjdEZpbGUsXHJcblx0VEZpbGUsXHJcblx0V29ya3NwYWNlLFxyXG5cdFdvcmtzcGFjZUNvbnRhaW5lciwgV29ya3NwYWNlSXRlbSxcclxuXHRXb3Jrc3BhY2VMZWFmXHJcbn0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBFbWJlZGRlZFZpZXcsIGlzRW1lYmVkZGVkTGVhZiwgc3Bhd25MZWFmVmlldyB9IGZyb20gXCIuL2xlYWZWaWV3XCI7XHJcbmltcG9ydCB7IGFyb3VuZCB9IGZyb20gXCJtb25rZXktYXJvdW5kXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGbG9hdFNlYXJjaFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcblx0cHJpdmF0ZSBzdGF0ZTogYW55O1xyXG5cdHByaXZhdGUgYXBwbHlEZWJvdW5jZVRpbWVyID0gMDtcclxuXHRwcml2YXRlIG1vZGFsOiBGbG9hdFNlYXJjaE1vZGFsO1xyXG5cclxuXHRwdWJsaWMgYXBwbHlTZXR0aW5nc1VwZGF0ZSgpIHtcclxuXHRcdGNsZWFyVGltZW91dCh0aGlzLmFwcGx5RGVib3VuY2VUaW1lcik7XHJcblx0XHR0aGlzLmFwcGx5RGVib3VuY2VUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0dGhpcy5zdGF0ZSA9IHtcclxuXHRcdFx0XHQuLi50aGlzLnN0YXRlLFxyXG5cdFx0XHRcdHF1ZXJ5OiBcIlwiLFxyXG5cdFx0XHR9O1xyXG5cdFx0fSwgMzAwMDApO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgb25sb2FkKCkge1xyXG5cdFx0dGhpcy5wYXRjaFdvcmtzcGFjZSgpO1xyXG5cdFx0dGhpcy5wYXRjaFdvcmtzcGFjZUxlYWYoKTtcclxuXHJcblx0XHR0aGlzLnJlZ2lzdGVyT2JzaWRpYW5VUklIYW5kbGVyKCk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyT2JzaWRpYW5Db21tYW5kcygpO1xyXG5cdFx0dGhpcy5yZWdpc3RlckVkaXRvck1lbnVIYW5kbGVyKCk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyQ29udGV4dE1lbnVIYW5kbGVyKCk7XHJcblxyXG5cdFx0dGhpcy5hZGRSaWJib25JY29uKCdzZWFyY2gnLCAnU2VhcmNoIE9ic2lkaWFuIEluIE1vZGFsJywgKCkgPT4ge1xyXG5cdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xyXG5cdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuXHRcdFx0XHR0aGlzLmFwcGx5U2V0dGluZ3NVcGRhdGUoKTtcclxuXHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgdGhpcy5zdGF0ZSk7XHJcblx0XHRcdHRoaXMubW9kYWwub3BlbigpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRvbnVubG9hZCgpIHtcclxuXHRcdHRoaXMuc3RhdGUgPSB1bmRlZmluZWQ7XHJcblx0fVxyXG5cclxuXHRwYXRjaFdvcmtzcGFjZSgpIHtcclxuXHRcdGxldCBsYXlvdXRDaGFuZ2luZyA9IGZhbHNlO1xyXG5cdFx0Y29uc3QgdW5pbnN0YWxsZXIgPSBhcm91bmQoV29ya3NwYWNlLnByb3RvdHlwZSwge1xyXG5cdFx0XHRnZXRMZWFmOiAobmV4dCkgPT5cclxuXHRcdFx0XHRmdW5jdGlvbiAoLi4uYXJncykge1xyXG5cdFx0XHRcdFx0Y29uc3QgYWN0aXZlTGVhZiA9IHRoaXMuYWN0aXZlTGVhZjtcclxuXHRcdFx0XHRcdGlmKGFjdGl2ZUxlYWYpIHtcclxuXHRcdFx0XHRcdFx0Y29uc3QgZnNDdG5FbCA9IChhY3RpdmVMZWFmLnBhcmVudC5jb250YWluZXJFbCBhcyBIVE1MRWxlbWVudCkucGFyZW50RWxlbWVudDtcclxuXHRcdFx0XHRcdFx0aWYoZnNDdG5FbD8uY2xhc3NMaXN0LmNvbnRhaW5zKFwiZnMtY29udGVudFwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmKGFjdGl2ZUxlYWYudmlldy5nZXRWaWV3VHlwZSgpID09PSBcIm1hcmtkb3duXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBhY3RpdmVMZWFmO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRjb25zdCBuZXdMZWFmID0gYXBwLndvcmtzcGFjZS5nZXRVbnBpbm5lZExlYWYoKTtcclxuXHRcdFx0XHRcdFx0XHRpZihuZXdMZWFmKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnNldEFjdGl2ZUxlYWYobmV3TGVhZik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHJldHVybiBuZXh0LmNhbGwodGhpcywgLi4uYXJncyk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZXR1cm4gbmV4dC5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRjaGFuZ2VMYXlvdXQob2xkKSB7XHJcblx0XHRcdFx0cmV0dXJuIGFzeW5jIGZ1bmN0aW9uICh3b3Jrc3BhY2U6IHVua25vd24pIHtcclxuXHRcdFx0XHRcdGxheW91dENoYW5naW5nID0gdHJ1ZTtcclxuXHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdC8vIERvbid0IGNvbnNpZGVyIGhvdmVyIHBvcG92ZXJzIHBhcnQgb2YgdGhlIHdvcmtzcGFjZSB3aGlsZSBpdCdzIGNoYW5naW5nXHJcblx0XHRcdFx0XHRcdGF3YWl0IG9sZC5jYWxsKHRoaXMsIHdvcmtzcGFjZSk7XHJcblx0XHRcdFx0XHR9IGZpbmFsbHkge1xyXG5cdFx0XHRcdFx0XHRsYXlvdXRDaGFuZ2luZyA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH07XHJcblx0XHRcdH0sXHJcblx0XHRcdGl0ZXJhdGVMZWF2ZXMob2xkKSB7XHJcblx0XHRcdFx0dHlwZSBsZWFmSXRlcmF0b3IgPSAoaXRlbTogV29ya3NwYWNlTGVhZikgPT4gYm9vbGVhbiB8IHZvaWQ7XHJcblx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uIChhcmcxLCBhcmcyKSB7XHJcblx0XHRcdFx0XHQvLyBGYXN0IGV4aXQgaWYgZGVzaXJlZCBsZWFmIGZvdW5kXHJcblx0XHRcdFx0XHRpZiAob2xkLmNhbGwodGhpcywgYXJnMSwgYXJnMikpIHJldHVybiB0cnVlO1xyXG5cclxuXHRcdFx0XHRcdC8vIEhhbmRsZSBvbGQvbmV3IEFQSSBwYXJhbWV0ZXIgc3dhcFxyXG5cdFx0XHRcdFx0Y29uc3QgY2I6ICAgICBsZWFmSXRlcmF0b3IgID0gKHR5cGVvZiBhcmcxID09PSBcImZ1bmN0aW9uXCIgPyBhcmcxIDogYXJnMikgYXMgbGVhZkl0ZXJhdG9yO1xyXG5cdFx0XHRcdFx0Y29uc3QgcGFyZW50OiBXb3Jrc3BhY2VJdGVtID0gKHR5cGVvZiBhcmcxID09PSBcImZ1bmN0aW9uXCIgPyBhcmcyIDogYXJnMSkgYXMgV29ya3NwYWNlSXRlbTtcclxuXHJcblx0XHRcdFx0XHRpZiAoIXBhcmVudCkgcmV0dXJuIGZhbHNlOyAgLy8gPC0gZHVyaW5nIGFwcCBzdGFydHVwLCByb290U3BsaXQgY2FuIGJlIG51bGxcclxuXHRcdFx0XHRcdGlmIChsYXlvdXRDaGFuZ2luZykgcmV0dXJuIGZhbHNlOyAgLy8gRG9uJ3QgbGV0IEhFcyBjbG9zZSBkdXJpbmcgd29ya3NwYWNlIGNoYW5nZVxyXG5cclxuXHRcdFx0XHRcdC8vIDAuMTQueCBkb2Vzbid0IGhhdmUgV29ya3NwYWNlQ29udGFpbmVyOyB0aGlzIGNhbiBqdXN0IGJlIGFuIGluc3RhbmNlb2YgY2hlY2sgb25jZSAxNS54IGlzIG1hbmRhdG9yeTpcclxuXHRcdFx0XHRcdGlmIChwYXJlbnQgPT09IGFwcC53b3Jrc3BhY2Uucm9vdFNwbGl0IHx8IChXb3Jrc3BhY2VDb250YWluZXIgJiYgcGFyZW50IGluc3RhbmNlb2YgV29ya3NwYWNlQ29udGFpbmVyKSkge1xyXG5cdFx0XHRcdFx0XHRmb3IoY29uc3QgcG9wb3ZlciBvZiBFbWJlZGRlZFZpZXcucG9wb3ZlcnNGb3JXaW5kb3coKHBhcmVudCBhcyBXb3Jrc3BhY2VDb250YWluZXIpLndpbikpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBVc2Ugb2xkIEFQSSBoZXJlIGZvciBjb21wYXQgdy8wLjE0LnhcclxuXHRcdFx0XHRcdFx0XHRpZiAob2xkLmNhbGwodGhpcywgY2IsIHBvcG92ZXIucm9vdFNwbGl0KSkgcmV0dXJuIHRydWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9O1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRvbkRyYWdMZWFmKG9sZCkge1xyXG5cdFx0XHRcdHJldHVybiBmdW5jdGlvbiAoZXZlbnQ6IE1vdXNlRXZlbnQsIGxlYWY6IFdvcmtzcGFjZUxlYWYpIHtcclxuXHRcdFx0XHRcdHJldHVybiBvbGQuY2FsbCh0aGlzLCBldmVudCwgbGVhZik7XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHR0aGlzLnJlZ2lzdGVyKHVuaW5zdGFsbGVyKTtcclxuXHR9XHJcblxyXG5cdC8vIFVzZWQgZm9yIHBhdGNoIHdvcmtzcGFjZWxlYWYgcGlubmVkIGJlaGF2aW9yc1xyXG5cdHBhdGNoV29ya3NwYWNlTGVhZigpIHtcclxuXHRcdHRoaXMucmVnaXN0ZXIoXHJcblx0XHRcdGFyb3VuZChXb3Jrc3BhY2VMZWFmLnByb3RvdHlwZSwge1xyXG5cdFx0XHRcdGdldFJvb3Qob2xkKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHRjb25zdCB0b3AgPSBvbGQuY2FsbCh0aGlzKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIHRvcD8uZ2V0Um9vdCA9PT0gdGhpcy5nZXRSb290ID8gdG9wIDogdG9wPy5nZXRSb290KCk7XHJcblx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0c2V0UGlubmVkKG9sZCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uIChwaW5uZWQ6IGJvb2xlYW4pIHtcclxuXHRcdFx0XHRcdFx0b2xkLmNhbGwodGhpcywgcGlubmVkKTtcclxuXHRcdFx0XHRcdFx0aWYoaXNFbWViZWRkZWRMZWFmKHRoaXMpICYmICFwaW5uZWQpIHRoaXMuc2V0UGlubmVkKHRydWUpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0b3BlbkZpbGUob2xkKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZnVuY3Rpb24gKGZpbGU6IFRGaWxlLCBvcGVuU3RhdGU/OiBPcGVuVmlld1N0YXRlKSB7XHJcblx0XHRcdFx0XHRcdGlmIChpc0VtZWJlZGRlZExlYWYodGhpcykpIHtcclxuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KFxyXG5cdFx0XHRcdFx0XHRcdFx0YXJvdW5kKFdvcmtzcGFjZS5wcm90b3R5cGUsIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0cmVjb3JkTW9zdFJlY2VudE9wZW5lZEZpbGUob2xkKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGZ1bmN0aW9uIChfZmlsZTogVEZpbGUpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIERvbid0IHVwZGF0ZSB0aGUgcXVpY2sgc3dpdGNoZXIncyByZWNlbnQgbGlzdFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKF9maWxlICE9PSBmaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBvbGQuY2FsbCh0aGlzLCBfZmlsZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSxcclxuXHRcdFx0XHRcdFx0XHRcdH0pLFxyXG5cdFx0XHRcdFx0XHRcdFx0MSxcclxuXHRcdFx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IHJlY2VudEZpbGVzID0gdGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zW1wicmVjZW50LWZpbGVzLW9ic2lkaWFuXCJdO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChyZWNlbnRGaWxlcykge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dChcclxuXHRcdFx0XHRcdFx0XHRcdFx0YXJvdW5kKHJlY2VudEZpbGVzLCB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2hvdWxkQWRkRmlsZShvbGQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbiAoX2ZpbGU6IFRGaWxlKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIERvbid0IHVwZGF0ZSB0aGUgUmVjZW50IEZpbGVzIHBsdWdpblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gX2ZpbGUgIT09IGZpbGUgJiYgb2xkLmNhbGwodGhpcywgX2ZpbGUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0MSxcclxuXHRcdFx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0Y29uc3QgdmlldyA9IG9sZC5jYWxsKHRoaXMsIGZpbGUsIG9wZW5TdGF0ZSk7XHJcblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCk9PntcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBmc0N0bkVsID0gKHRoaXMucGFyZW50LmNvbnRhaW5lckVsIGFzIEhUTUxFbGVtZW50KS5wYXJlbnRFbGVtZW50O1xyXG5cdFx0XHRcdFx0XHRcdGlmKCEoZnNDdG5FbD8uY2xhc3NMaXN0LmNvbnRhaW5zKFwiZnMtY29udGVudFwiKSkpIHJldHVybjtcclxuXHRcdFx0XHRcdFx0XHRpZihmaWxlLmV4dGVuc2lvbiAhPSBcImNhbnZhc1wiICkgcmV0dXJuO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjYW52YXMgPSB0aGlzLnZpZXcuY2FudmFzO1xyXG5cdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCk9PntcclxuXHRcdFx0XHRcdFx0XHRcdGlmKGNhbnZhcyAmJiBvcGVuU3RhdGU/LmVTdGF0ZT8ubWF0Y2gpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0bGV0IG5vZGUgPSBjYW52YXMuZGF0YS5ub2Rlcz8uZmluZCgoZTogYW55KT0+IGUudGV4dCA9PT0gb3BlblN0YXRlLmVTdGF0ZS5tYXRjaC5jb250ZW50KTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0bm9kZSA9IGNhbnZhcy5ub2Rlcy5nZXQobm9kZS5pZCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRjYW52YXMuc2VsZWN0T25seShub2RlKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y2FudmFzLnpvb21Ub1NlbGVjdGlvbigpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9LDIwKTtcclxuXHRcdFx0XHRcdFx0fSwgMSk7XHJcblxyXG5cdFx0XHRcdFx0XHRyZXR1cm4gdmlldztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pLFxyXG5cdFx0KTtcclxuXHR9XHJcblxyXG5cdHJlZ2lzdGVyT2JzaWRpYW5VUklIYW5kbGVyKCkge1xyXG5cdFx0dGhpcy5yZWdpc3Rlck9ic2lkaWFuUHJvdG9jb2xIYW5kbGVyKFwiZnNcIiwgKHBhdGgpPT57XHJcblx0XHRcdHRoaXMubW9kYWwgPSBuZXcgRmxvYXRTZWFyY2hNb2RhbCgoc3RhdGUpPT57XHJcblx0XHRcdFx0dGhpcy5zdGF0ZSA9IHN0YXRlO1xyXG5cdFx0XHRcdHRoaXMuYXBwbHlTZXR0aW5nc1VwZGF0ZSgpO1xyXG5cdFx0XHR9LHRoaXMuYXBwLCB0aGlzLCB7IHF1ZXJ5OiBwYXRoLnF1ZXJ5LCBjdXJyZW50OiBmYWxzZSB9KTtcclxuXHRcdFx0dGhpcy5tb2RhbC5vcGVuKCk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHJlZ2lzdGVyT2JzaWRpYW5Db21tYW5kcygpIHtcclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnc2VhcmNoLW9ic2lkaWFuLWdsb2JhbGx5JyxcclxuXHRcdFx0bmFtZTogJ1NlYXJjaCBPYnNpZGlhbiBHbG9iYWxseScsXHJcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5tb2RhbCA9IG5ldyBGbG9hdFNlYXJjaE1vZGFsKChzdGF0ZSk9PntcclxuXHRcdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuXHRcdFx0XHR9LHRoaXMuYXBwLCB0aGlzLCB7Li4udGhpcy5zdGF0ZSwgcXVlcnk6IFwiXCIsIGN1cnJlbnQ6IGZhbHNlfSk7XHJcblx0XHRcdFx0dGhpcy5tb2RhbC5vcGVuKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ3NlYXJjaC1vYnNpZGlhbi1nbG9iYWxseS1zdGF0ZScsXHJcblx0XHRcdG5hbWU6ICdTZWFyY2ggT2JzaWRpYW4gR2xvYmFsbHkgKFdpdGggTGFzdCBTdGF0ZSknLFxyXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xyXG5cdFx0XHRcdHRoaXMubW9kYWwgPSBuZXcgRmxvYXRTZWFyY2hNb2RhbCgoc3RhdGUpPT57XHJcblx0XHRcdFx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XHJcblx0XHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgey4uLnRoaXMuc3RhdGUsIGN1cnJlbnQ6IGZhbHNlfSk7XHJcblx0XHRcdFx0dGhpcy5tb2RhbC5vcGVuKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0ICAgIGlkOiAnc2VhcmNoLWluLWJhY2tsaW5rJyxcclxuXHRcdCAgICBuYW1lOiAnU2VhcmNoIEluIEJhY2tsaW5rIE9mIEN1cnJlbnQgRmlsZScsXHJcblx0XHQgICAgY2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XHJcblx0XHQgICAgICAgIC8vIENvbmRpdGlvbnMgdG8gY2hlY2tcclxuXHRcdFx0XHRjb25zdCBhY3RpdmVMZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWY7XHJcblx0XHRcdFx0aWYoIWFjdGl2ZUxlYWYpIHJldHVybjtcclxuXHJcblx0XHRcdFx0Y29uc3Qgdmlld1R5cGUgPSBhY3RpdmVMZWFmLnZpZXcuZ2V0Vmlld1R5cGUoKTtcclxuXHRcdFx0XHRpZiAodmlld1R5cGUgPT09IFwibWFya2Rvd25cIiB8fCB2aWV3VHlwZSA9PT0gXCJjYW52YXNcIikge1xyXG5cdFx0XHRcdFx0aWYgKCFjaGVja2luZykge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZSA9IGFjdGl2ZUxlYWYudmlldy5maWxlO1xyXG5cclxuXHRcdFx0XHRcdFx0dGhpcy5tb2RhbCA9IG5ldyBGbG9hdFNlYXJjaE1vZGFsKChzdGF0ZSk9PntcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5hcHBseVNldHRpbmdzVXBkYXRlKCk7XHJcblx0XHRcdFx0XHRcdH0sdGhpcy5hcHAsIHRoaXMsIHsuLi50aGlzLnN0YXRlLCBxdWVyeTogXCIgL1xcXFxbXFxcXFtcIiArIChjdXJyZW50RmlsZS5leHRlbnNpb24gPT09IFwiY2FudmFzXCIgPyBjdXJyZW50RmlsZS5uYW1lIDogY3VycmVudEZpbGUuYmFzZW5hbWUpICsgXCIoXFxcXHxbXlxcXFxdXSopP1xcXFxdXFxcXF0vXCIsIGN1cnJlbnQ6IHRydWUgfSk7XHJcblx0XHRcdFx0XHRcdHRoaXMubW9kYWwub3BlbigpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdCAgICB9XHJcblx0XHR9KTtcclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0ICAgIGlkOiAnc2VhcmNoLWluLWN1cnJlbnQtZmlsZScsXHJcblx0XHQgICAgbmFtZTogJ1NlYXJjaCBJbiBDdXJyZW50IEZpbGUnLFxyXG5cdFx0ICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG5cdFx0ICAgICAgICAvLyBDb25kaXRpb25zIHRvIGNoZWNrXHJcblx0XHRcdFx0Y29uc3QgYWN0aXZlTGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmO1xyXG5cdFx0XHRcdGlmKCFhY3RpdmVMZWFmKSByZXR1cm47XHJcblxyXG5cdFx0XHRcdGNvbnN0IHZpZXdUeXBlID0gYWN0aXZlTGVhZi52aWV3LmdldFZpZXdUeXBlKCk7XHJcblx0XHQgICAgICAgIGlmICh2aWV3VHlwZSA9PT0gXCJtYXJrZG93blwiIHx8IHZpZXdUeXBlID09PSBcImNhbnZhc1wiKSB7XHJcblx0XHQgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRGaWxlID0gYWN0aXZlTGVhZi52aWV3LmZpbGU7XHJcblxyXG5cdFx0XHRcdFx0XHR0aGlzLm1vZGFsID0gbmV3IEZsb2F0U2VhcmNoTW9kYWwoKHN0YXRlKT0+e1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmFwcGx5U2V0dGluZ3NVcGRhdGUoKTtcclxuXHRcdFx0XHRcdFx0fSx0aGlzLmFwcCwgdGhpcywgey4uLnRoaXMuc3RhdGUsIHF1ZXJ5OiBcIiBwYXRoOlwiICsgY3VycmVudEZpbGUucGF0aCwgY3VycmVudDogdHJ1ZSB9KTtcclxuXHRcdFx0XHRcdFx0dGhpcy5tb2RhbC5vcGVuKCk7XHJcblx0XHQgICAgICAgICAgICB9XHJcblxyXG5cdFx0ICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcblx0XHQgICAgICAgIH1cclxuXHRcdCAgICB9XHJcblx0XHR9KTtcclxuXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0ICAgIGlkOiAnb3Blbi1zZWFyY2gtdmlldycsXHJcblx0XHQgICAgbmFtZTogJ09wZW4gU2VhcmNoIFZpZXcnLFxyXG5cdFx0ICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgbGVhZiA9IGFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpO1xyXG5cdFx0XHRcdGxlYWYuc2V0UGlubmVkKHRydWUpO1xyXG5cdFx0XHRcdGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcclxuXHRcdFx0XHRcdHR5cGU6IFwic2VhcmNoXCIsXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiAnb3Blbi1zZWFyY2gtdmlldy13aW5kb3cnLFxyXG5cdFx0XHRuYW1lOiAnT3BlbiBTZWFyY2ggVmlldyBXaW5kb3cnLFxyXG5cdFx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGxlYWYgPSBhcHAud29ya3NwYWNlLmdldExlYWYoJ3dpbmRvdycpO1xyXG5cdFx0XHRcdGxlYWYuc2V0UGlubmVkKHRydWUpO1xyXG5cdFx0XHRcdGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcclxuXHRcdFx0XHRcdHR5cGU6IFwic2VhcmNoXCIsXHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0cmVnaXN0ZXJFZGl0b3JNZW51SGFuZGxlcigpIHtcclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51OiBNZW51LCBlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XHJcblx0XHRcdFx0aWYgKCFlZGl0b3IpIHtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGVkaXRvci5nZXRTZWxlY3Rpb24oKS5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y29uc3Qgc2VsZWN0aW9uID0gZWRpdG9yLmdldFNlbGVjdGlvbigpLnRyaW0oKTtcclxuXHRcdFx0XHRsZXQgc2VhcmNoV29yZCA9IHNlbGVjdGlvbjtcclxuXHJcblx0XHRcdFx0aWYoc2VsZWN0aW9uLmxlbmd0aCA+IDgpIHtcclxuXHRcdFx0XHRcdHNlYXJjaFdvcmQgPSBzZWxlY3Rpb24uc3Vic3RyaW5nKDAsIDMpICsgXCIuLi5cIiArIHNlbGVjdGlvbi5zdWJzdHJpbmcoc2VsZWN0aW9uLmxlbmd0aCAtIDMsIHNlbGVjdGlvbi5sZW5ndGgpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRzZWFyY2hXb3JkID0gc2VsZWN0aW9uO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcblx0XHRcdFx0XHQvLyBBZGQgc3ViIG1lbnVcclxuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoJ1NlYXJjaCBcIicgKyBzZWFyY2hXb3JkICsgJ1wiJyArIFwiIGluIEZsb2F0IFNlYXJjaFwiKS5zZXRJY29uKFwic2VhcmNoXCIpXHJcblx0XHRcdFx0XHRcdC5vbkNsaWNrKCgpPT57XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5tb2RhbCA9IG5ldyBGbG9hdFNlYXJjaE1vZGFsKChzdGF0ZSk9PntcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuYXBwbHlTZXR0aW5nc1VwZGF0ZSgpO1xyXG5cdFx0XHRcdFx0XHRcdH0sdGhpcy5hcHAsIHRoaXMsIHsgcXVlcnk6IHNlbGVjdGlvbiwgY3VycmVudDogZmFsc2UgfSk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5tb2RhbC5vcGVuKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0fSlcclxuXHRcdFx0fSkpXHJcblx0fVxyXG5cclxuXHRyZWdpc3RlckNvbnRleHRNZW51SGFuZGxlcigpIHtcclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdCAgdGhpcy5hcHAud29ya3NwYWNlLm9uKFwiZmlsZS1tZW51XCIsIChtZW51OiBNZW51LCBmaWxlOiBUQWJzdHJhY3RGaWxlLCBzb3VyY2U6IHN0cmluZywgbGVhZj86IFdvcmtzcGFjZUxlYWYpID0+IHtcclxuXHRcdFx0Y29uc3QgcG9wb3ZlciA9IGxlYWYgPyBFbWJlZGRlZFZpZXcuZm9yTGVhZihsZWFmKSA6IHVuZGVmaW5lZDtcclxuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiAhcG9wb3ZlciAmJiAhbGVhZikge1xyXG5cdFx0XHQgIG1lbnUuYWRkSXRlbShpdGVtID0+IHtcclxuXHRcdFx0XHRpdGVtXHJcblx0XHRcdFx0ICAuc2V0SWNvbihcInBvcHVwLW9wZW5cIilcclxuXHRcdFx0XHQgIC5zZXRUaXRsZShcIk9wZW4gaW4gRmxvYXQgUHJldmlld1wiKVxyXG5cdFx0XHRcdCAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0aWYodGhpcy5tb2RhbCkge1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLm1vZGFsLmluaXRGaWxlVmlldyhmaWxlLCB1bmRlZmluZWQpO1xyXG5cclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdHRoaXMubW9kYWwgPSBuZXcgRmxvYXRTZWFyY2hNb2RhbCgoc3RhdGUpPT57XHJcblx0XHRcdFx0XHRcdHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuXHRcdFx0XHRcdFx0dGhpcy5hcHBseVNldHRpbmdzVXBkYXRlKCk7XHJcblx0XHRcdFx0XHR9LHRoaXMuYXBwLCB0aGlzLCB7IHF1ZXJ5OiBcIlwiLCBjdXJyZW50OiBmYWxzZSB9KTtcclxuXHRcdFx0XHRcdHRoaXMubW9kYWwub3BlbigpO1xyXG5cdFx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKT0+e1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLm1vZGFsLmluaXRGaWxlVmlldyhmaWxlLCB1bmRlZmluZWQpO1xyXG5cdFx0XHRcdFx0fSwgMjApO1xyXG5cdFx0XHRcdCAgfSlcclxuXHRcdFx0XHQgIC5zZXRTZWN0aW9uPy4oXCJvcGVuXCIpO1xyXG5cdFx0XHQgIH0pO1xyXG5cdFx0XHR9XHJcblx0XHQgIH0pLFxyXG5cdFx0KTtcclxuXHQgIH1cclxufVxyXG5cclxuXHJcbmNsYXNzIEZsb2F0U2VhcmNoTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblx0cHJpdmF0ZSByZWFkb25seSBwbHVnaW46IEZsb2F0U2VhcmNoUGx1Z2luO1xyXG5cdHByaXZhdGUgc2VhcmNoRW1iZWRkZWRWaWV3OiBFbWJlZGRlZFZpZXc7XHJcblx0cHJpdmF0ZSBmaWxlRW1iZWRkZWRWaWV3OiBFbWJlZGRlZFZpZXc7XHJcblxyXG5cdHNlYXJjaExlYWY6IFdvcmtzcGFjZUxlYWY7XHJcblx0ZmlsZUxlYWY6IFdvcmtzcGFjZUxlYWYgfCB1bmRlZmluZWQ7XHJcblxyXG5cdHByaXZhdGUgY2I6IChzdGF0ZTogYW55KT0+IHZvaWQ7XHJcblx0cHJpdmF0ZSBzdGF0ZTogYW55O1xyXG5cclxuXHRwcml2YXRlIGZpbGVTdGF0ZTogYW55O1xyXG5cclxuXHRwcml2YXRlIHNlYXJjaEN0bkVsOiBIVE1MRWxlbWVudDtcclxuXHRwcml2YXRlIGluc3RydWN0aW9uc0VsOiBIVE1MRWxlbWVudDtcclxuXHRwcml2YXRlIGZpbGVFbDogSFRNTEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSB2aWV3VHlwZTogc3RyaW5nO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihjYjogKHN0YXRlOiBhbnkpPT4gdm9pZCwgYXBwOiBBcHAsIHBsdWdpbjogRmxvYXRTZWFyY2hQbHVnaW4sIHN0YXRlOiBhbnksIHZpZXdUeXBlOiBzdHJpbmcgPSBcInNlYXJjaFwiKSB7XHJcblx0XHRzdXBlcihhcHApO1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcblx0XHR0aGlzLmNiID0gY2I7XHJcblx0XHR0aGlzLnN0YXRlID0gc3RhdGU7XHJcblx0XHR0aGlzLnZpZXdUeXBlID0gdmlld1R5cGU7XHJcblx0fVxyXG5cclxuXHRhc3luYyBvbk9wZW4oKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCwgY29udGFpbmVyRWwsIG1vZGFsRWwgfSA9IHRoaXM7XHJcblxyXG5cdFx0dGhpcy5zZWFyY2hDdG5FbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLXNlYXJjaC1jdG5cIiB9KTtcclxuXHRcdHRoaXMuaW5zdHJ1Y3Rpb25zRWwgPSBtb2RhbEVsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zXCIgfSk7XHJcblxyXG5cdFx0dGhpcy5pbml0SW5zdHJ1Y3Rpb25zKHRoaXMuaW5zdHJ1Y3Rpb25zRWwpO1xyXG5cdFx0dGhpcy5pbml0Q3NzKGNvbnRlbnRFbCwgbW9kYWxFbCwgY29udGFpbmVyRWwpO1xyXG5cdFx0YXdhaXQgdGhpcy5pbml0U2VhcmNoVmlldyh0aGlzLnNlYXJjaEN0bkVsLCB0aGlzLnZpZXdUeXBlKTtcclxuXHRcdHRoaXMuaW5pdElucHV0KCk7XHJcblx0XHR0aGlzLmluaXRDb250ZW50KCk7XHJcblx0fVxyXG5cclxuXHRvbkNsb3NlKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblxyXG5cdFx0dGhpcy5jYih0aGlzLnNlYXJjaExlYWYudmlldy5nZXRTdGF0ZSgpKTtcclxuXHJcblx0XHR0aGlzLnNlYXJjaExlYWYuZGV0YWNoKCk7XHJcblx0XHR0aGlzLmZpbGVMZWFmPy5kZXRhY2goKTtcclxuXHRcdHRoaXMuc2VhcmNoRW1iZWRkZWRWaWV3LnVubG9hZCgpO1xyXG5cdFx0dGhpcy5maWxlRW1iZWRkZWRWaWV3Py51bmxvYWQoKTtcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdH1cclxuXHJcblx0aW5pdEluc3RydWN0aW9ucyhpbnN0cnVjdGlvbnNFbDogSFRNTEVsZW1lbnQpIHtcclxuXHRcdGNvbnN0IG5hdmlnYXRlSW5zdHJ1Y3Rpb25zRWwgPSBpbnN0cnVjdGlvbnNFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy1uYXZpZ2F0ZVwiIH0pO1xyXG5cdFx0Y29uc3QgY29sbGFwc2VJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWNvbGxhcHNlXCIgfSk7XHJcblx0XHRjb25zdCBlbnRlckluc3RydWN0aW9uc0VsID0gaW5zdHJ1Y3Rpb25zRWwuY3JlYXRlRGl2KHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1pbnN0cnVjdGlvbnMtZW50ZXJcIiB9KTtcclxuXHRcdGNvbnN0IGFsdEVudGVySW5zdHJ1Y3Rpb25zRWwgPSBpbnN0cnVjdGlvbnNFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy1hbHQtZW50ZXJcIiB9KTtcclxuXHJcblx0XHRjb25zdCB0YWJJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXRhYlwiIH0pO1xyXG5cdFx0Y29uc3Qgc3dpdGNoSW5zdHJ1Y3Rpb25zRWwgPSBpbnN0cnVjdGlvbnNFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy1zd2l0Y2hcIiB9KTtcclxuXHJcblx0XHRjb25zdCBuYXZpZ2F0ZUljb25FbCA9IG5hdmlnYXRlSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWtleVwiIH0pO1xyXG5cdFx0Y29uc3QgbmF2aWdhdGVUZXh0RWwgPSBuYXZpZ2F0ZUluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10ZXh0XCIgfSk7XHJcblx0XHRuYXZpZ2F0ZUljb25FbC5zZXRUZXh0KFwiXHUyMTkxXHUyMTkzXCIpO1xyXG5cdFx0bmF2aWdhdGVUZXh0RWwuc2V0VGV4dChcIk5hdmlnYXRlXCIpO1xyXG5cclxuXHRcdGNvbnN0IGNvbGxhcHNlSWNvbkVsID0gY29sbGFwc2VJbnN0cnVjdGlvbnNFbC5jcmVhdGVTcGFuKHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1pbnN0cnVjdGlvbnMta2V5XCIgfSk7XHJcblx0XHRjb25zdCBjb2xsYXBzZVRleHRFbCA9IGNvbGxhcHNlSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXRleHRcIiB9KTtcclxuXHRcdGNvbGxhcHNlSWNvbkVsLnNldFRleHQoXCJTaGlmdCtcdTIxOTFcdTIxOTNcIik7XHJcblx0XHRjb2xsYXBzZVRleHRFbC5zZXRUZXh0KFwiQ29sbGFwc2UvRXhwYW5kXCIpO1xyXG5cclxuXHRcdGNvbnN0IGVudGVySWNvbkVsID0gZW50ZXJJbnN0cnVjdGlvbnNFbC5jcmVhdGVTcGFuKHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1pbnN0cnVjdGlvbnMta2V5XCIgfSk7XHJcblx0XHRjb25zdCBlbnRlclRleHRFbCA9IGVudGVySW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXRleHRcIiB9KTtcclxuXHRcdGVudGVySWNvbkVsLnNldFRleHQoXCJcdTIxQjVcIik7XHJcblx0XHRlbnRlclRleHRFbC5zZXRUZXh0KFwiT3BlbiBpbiBiYWNrZ3JvdW5kXCIpO1xyXG5cclxuXHRcdGNvbnN0IGFsdEVudGVySWNvbkVsID0gYWx0RW50ZXJJbnN0cnVjdGlvbnNFbC5jcmVhdGVTcGFuKHsgY2xzOiBcImZsb2F0LXNlYXJjaC1tb2RhbC1pbnN0cnVjdGlvbnMta2V5XCIgfSk7XHJcblx0XHRjb25zdCBhbHRFbnRlclRleHRFbCA9IGFsdEVudGVySW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXRleHRcIiB9KTtcclxuXHRcdGFsdEVudGVySWNvbkVsLnNldFRleHQoXCJBbHQrXHUyMUI1XCIpO1xyXG5cdFx0YWx0RW50ZXJUZXh0RWwuc2V0VGV4dChcIk9wZW4gRmlsZSBhbmQgQ2xvc2VcIik7XHJcblxyXG5cdFx0Y29uc3QgdGFiSWNvbkVsID0gdGFiSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWtleVwiIH0pO1xyXG5cdFx0Y29uc3QgdGFiVGV4dEVsID0gdGFiSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLXRleHRcIiB9KTtcclxuXHRcdHRhYkljb25FbC5zZXRUZXh0KFwiVGFiL1NoaWZ0K1RhYlwiKTtcclxuXHRcdHRhYlRleHRFbC5zZXRUZXh0KFwiUHJldmlldy9DbG9zZSBQcmV2aWV3XCIpO1xyXG5cclxuXHRcdGNvbnN0IHN3aXRjaEljb25FbCA9IHN3aXRjaEluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy1rZXlcIiB9KTtcclxuXHRcdGNvbnN0IHN3aXRjaFRleHRFbCA9IHN3aXRjaEluc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10ZXh0XCIgfSk7XHJcblx0XHRzd2l0Y2hJY29uRWwuc2V0VGV4dChcIkN0cmwrR1wiKTtcclxuXHRcdHN3aXRjaFRleHRFbC5zZXRUZXh0KFwiU3dpdGNoIEJldHdlZW4gU2VhcmNoIGFuZCBGaWxlIFZpZXdcIik7XHJcblxyXG5cdFx0Y29uc3QgY2xpY2tJbnN0cnVjdGlvbnNFbCA9IGluc3RydWN0aW9uc0VsLmNyZWF0ZURpdih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWNsaWNrXCIgfSk7XHJcblx0XHRjb25zdCBjbGlja0ljb25FbCA9IGNsaWNrSW5zdHJ1Y3Rpb25zRWwuY3JlYXRlU3Bhbih7IGNsczogXCJmbG9hdC1zZWFyY2gtbW9kYWwtaW5zdHJ1Y3Rpb25zLWtleVwiIH0pO1xyXG5cdFx0Y29uc3QgY2xpY2tUZXh0RWwgPSBjbGlja0luc3RydWN0aW9uc0VsLmNyZWF0ZVNwYW4oeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWluc3RydWN0aW9ucy10ZXh0XCIgfSk7XHJcblx0XHRjbGlja0ljb25FbC5zZXRUZXh0KFwiQWx0K0NsaWNrXCIpO1xyXG5cdFx0Y2xpY2tUZXh0RWwuc2V0VGV4dChcIkNsb3NlIE1vZGFsIFdoaWxlIEluIEZpbGUgVmlld1wiKTtcclxuXHR9XHJcblxyXG5cdGluaXRDc3MoY29udGVudEVsOiBIVE1MRWxlbWVudCwgbW9kYWxFbDogSFRNTEVsZW1lbnQsIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCkge1xyXG5cdFx0Y29udGVudEVsLmNsYXNzTGlzdC5hZGQoXCJmbG9hdC1zZWFyY2gtbW9kYWwtY29udGVudFwiKTtcclxuXHRcdG1vZGFsRWwuY2xhc3NMaXN0LmFkZChcImZsb2F0LXNlYXJjaC1tb2RhbFwiKTtcclxuXHRcdGNvbnRhaW5lckVsLmNsYXNzTGlzdC5hZGQoXCJmbG9hdC1zZWFyY2gtbW9kYWwtY29udGFpbmVyXCIpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgaW5pdFNlYXJjaFZpZXcoY29udGVudEVsOiBIVE1MRWxlbWVudCwgdmlld1R5cGU6IHN0cmluZykge1xyXG5cdFx0Y29uc3QgW2NyZWF0ZWRMZWFmLCBlbWJlZGRlZFZpZXddID0gc3Bhd25MZWFmVmlldyh0aGlzLnBsdWdpbiwgY29udGVudEVsKTtcclxuXHRcdHRoaXMuc2VhcmNoTGVhZiA9IGNyZWF0ZWRMZWFmO1xyXG5cdFx0dGhpcy5zZWFyY2hFbWJlZGRlZFZpZXcgPSBlbWJlZGRlZFZpZXc7XHJcblxyXG5cdFx0dGhpcy5zZWFyY2hMZWFmLnNldFBpbm5lZCh0cnVlKTtcclxuXHRcdGF3YWl0IHRoaXMuc2VhcmNoTGVhZi5zZXRWaWV3U3RhdGUoe1xyXG5cdFx0XHR0eXBlOiBcInNlYXJjaFwiLFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0c2V0VGltZW91dChhc3luYyAoKT0+e1xyXG5cdFx0XHRhd2FpdCB0aGlzLnNlYXJjaExlYWYudmlldy5zZXRTdGF0ZSh0aGlzLnN0YXRlLCB0cnVlKTtcclxuXHRcdFx0dGhpcy5zdGF0ZT8uY3VycmVudCA/ICh0aGlzLnNlYXJjaExlYWYudmlldyBhcyBTZWFyY2hWaWV3KS5zZWFyY2hDb21wb25lbnQuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZSgwLCAwKSA6ICh0aGlzLnNlYXJjaExlYWYudmlldyBhcyBTZWFyY2hWaWV3KS5zZWFyY2hDb21wb25lbnQuaW5wdXRFbC5zZXRTZWxlY3Rpb25SYW5nZSgwLCB0aGlzLnN0YXRlPy5xdWVyeT8ubGVuZ3RoKTtcclxuXHRcdH0sIDApO1xyXG5cclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdGluaXRJbnB1dCgpIHtcclxuXHRcdGNvbnN0IGlucHV0RWwgPSB0aGlzLmNvbnRlbnRFbC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpWzBdO1xyXG5cdFx0aW5wdXRFbC5mb2N1cygpO1xyXG5cdFx0aW5wdXRFbC5vbmtleWRvd24gPSAoZSkgPT4ge1xyXG5cdFx0XHRjb25zdCBjdXJyZW50VmlldyA9IHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXc7XHJcblx0XHRcdHN3aXRjaCAoZS5rZXkpIHtcclxuXHRcdFx0XHRjYXNlIFwiQXJyb3dEb3duXCI6XHJcblx0XHRcdFx0XHRpZiAoZS5zaGlmdEtleSkge1xyXG5cdFx0XHRcdFx0XHRjdXJyZW50Vmlldy5vbktleVNob3dNb3JlQWZ0ZXIoZSk7XHJcblx0XHRcdFx0XHRcdGlmKGN1cnJlbnRWaWV3LmRvbS5mb2N1c2VkSXRlbSkge1xyXG5cdFx0XHRcdFx0XHRcdGlmKGN1cnJlbnRWaWV3LmRvbS5mb2N1c2VkSXRlbS5jb2xsYXBzaWJsZSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y3VycmVudFZpZXcuZG9tLmZvY3VzZWRJdGVtLnNldENvbGxhcHNlKGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRjdXJyZW50Vmlldy5vbktleUFycm93RG93bkluRm9jdXMoZSk7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdGNhc2UgXCJBcnJvd1VwXCI6XHJcblx0XHRcdFx0XHRpZiAoZS5zaGlmdEtleSkge1xyXG5cdFx0XHRcdFx0XHRjdXJyZW50Vmlldy5vbktleVNob3dNb3JlQmVmb3JlKGUpO1xyXG5cdFx0XHRcdFx0XHRpZihjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0XHRpZihjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0uY29sbGFwc2VFbCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y3VycmVudFZpZXcuZG9tLmZvY3VzZWRJdGVtLnNldENvbGxhcHNlKHRydWUpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdGN1cnJlbnRWaWV3Lm9uS2V5QXJyb3dVcEluRm9jdXMoZSk7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdGNhc2UgXCJBcnJvd0xlZnRcIjpcclxuXHRcdFx0XHRcdGN1cnJlbnRWaWV3Lm9uS2V5QXJyb3dMZWZ0SW5Gb2N1cyhlKTtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJBcnJvd1JpZ2h0XCI6XHJcblx0XHRcdFx0XHRjdXJyZW50Vmlldy5vbktleUFycm93UmlnaHRJbkZvY3VzKGUpO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcIkVudGVyXCI6XHJcblx0XHRcdFx0XHRjdXJyZW50Vmlldy5vbktleUVudGVySW5Gb2N1cyhlKTtcclxuXHRcdFx0XHRcdGlmKGUuYWx0S2V5ICYmIGN1cnJlbnRWaWV3LmRvbS5mb2N1c2VkSXRlbSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRjYXNlIFwiVGFiXCI6XHJcblx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRpZihlLnNoaWZ0S2V5KSB7XHJcblx0XHRcdFx0XHRcdGlmKHRoaXMuZmlsZUxlYWYpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmZpbGVMZWFmPy5kZXRhY2goKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmZpbGVMZWFmID0gdW5kZWZpbmVkO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuZmlsZUVtYmVkZGVkVmlldz8udW5sb2FkKCk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5tb2RhbEVsLnRvZ2dsZUNsYXNzKFwiZmxvYXQtc2VhcmNoLXdpZHRoXCIsIGZhbHNlKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmZpbGVFbC5kZXRhY2goKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRpZihjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0pIHtcclxuXHRcdFx0XHRcdFx0Y29uc3QgaXRlbSA9IGN1cnJlbnRWaWV3LmRvbS5mb2N1c2VkSXRlbTtcclxuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZSA9IGl0ZW0ucGFyZW50LmZpbGUgaW5zdGFuY2VvZiBURmlsZSA/IGl0ZW0ucGFyZW50LmZpbGUgOiBpdGVtLmZpbGU7XHJcblxyXG5cdFx0XHRcdFx0XHRpdGVtLnBhcmVudC5maWxlIGluc3RhbmNlb2YgVEZpbGUgPyB0aGlzLmluaXRGaWxlVmlldyhmaWxlLCB7bWF0Y2g6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGl0ZW0uY29udGVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXM6IGl0ZW0ubWF0Y2hlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9fSkgOiB0aGlzLmluaXRGaWxlVmlldyhmaWxlLCB1bmRlZmluZWQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImVcIjpcclxuXHRcdFx0XHRcdGlmKGUuY3RybEtleSkge1xyXG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdGlmKHRoaXMuZmlsZUxlYWYpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBlc3RhdGUgPSB0aGlzLmZpbGVMZWFmLmdldFZpZXdTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgXHRcdFx0ZXN0YXRlLnN0YXRlLm1vZGUgPSBcInByZXZpZXdcIiA9PT0gZXN0YXRlLnN0YXRlLm1vZGUgPyBcInNvdXJjZVwiIDogXCJwcmV2aWV3XCI7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy5maWxlTGVhZi5zZXRWaWV3U3RhdGUoZXN0YXRlLCB7XHJcblx0XHRcdFx0XHRcdFx0XHRmb2N1czogITBcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0XHRzZXRUaW1lb3V0KCgpPT57XHJcblx0XHRcdFx0XHRcdFx0XHQodGhpcy5zZWFyY2hMZWFmLnZpZXcgYXMgU2VhcmNoVmlldykuc2VhcmNoQ29tcG9uZW50LmlucHV0RWwuZm9jdXMoKTtcclxuXHRcdFx0XHRcdFx0XHR9LCAwKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRjYXNlIFwiZ1wiOlxyXG5cdFx0XHRcdFx0aWYodGhpcy5maWxlTGVhZiAmJiBlLmN0cmxLZXkpIHtcclxuXHRcdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdFx0XHRhcHAud29ya3NwYWNlLnNldEFjdGl2ZUxlYWYodGhpcy5maWxlTGVhZiwge1xyXG5cdFx0XHRcdFx0XHRcdGZvY3VzOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGNhc2UgXCJDXCI6XHJcblx0XHRcdFx0XHRpZihlLmN0cmxLZXkgJiYgZS5zaGlmdEtleSkge1xyXG5cdFx0XHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IHRleHQgPSBjdXJyZW50Vmlldy5kb20uZm9jdXNlZEl0ZW0uZWwuaW5uZXJUZXh0O1xyXG5cdFx0XHRcdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0ZXh0KTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGluaXRDb250ZW50KCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwub25jbGljayA9IChlKSA9PiB7XHJcblx0XHRcdGNvbnN0IHJlc3VsdEVsZW1lbnQgPSBjb250ZW50RWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2VhcmNoLXJlc3VsdHMtY2hpbGRyZW4nKVswXTtcclxuXHRcdFx0aWYocmVzdWx0RWxlbWVudC5jaGlsZHJlbi5sZW5ndGggPCAyKSAge1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IHRhcmdldEVsZW1lbnQgPSBlLnRhcmdldCBhcyBIVE1MRWxlbWVudCB8IG51bGw7XHJcblxyXG5cdFx0XHRpZihlLmFsdEtleSB8fCAhdGhpcy5maWxlTGVhZikge1xyXG5cdFx0XHRcdHdoaWxlICh0YXJnZXRFbGVtZW50KSB7XHJcblx0XHRcdFx0XHRpZiAodGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3RyZWUtaXRlbS1pY29uJykpIHtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAodGFyZ2V0RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ3RyZWUtaXRlbScpKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0YXJnZXRFbGVtZW50ID0gdGFyZ2V0RWxlbWVudC5wYXJlbnRFbGVtZW50O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmKHRoaXMuZmlsZUxlYWYpIHtcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50VmlldyA9IHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXc7XHJcblxyXG5cdFx0XHRcdGlmKCh0aGlzLnNlYXJjaEN0bkVsIGFzIE5vZGUpLmNvbnRhaW5zKHRhcmdldEVsZW1lbnQgYXMgTm9kZSkpIHtcclxuXHRcdFx0XHRcdHdoaWxlICh0YXJnZXRFbGVtZW50KSB7XHJcblx0XHRcdFx0XHRcdGlmICh0YXJnZXRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygndHJlZS1pdGVtJykpIHtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR0YXJnZXRFbGVtZW50ID0gdGFyZ2V0RWxlbWVudC5wYXJlbnRFbGVtZW50O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0aWYoIXRhcmdldEVsZW1lbnQpIHJldHVybjtcclxuXHJcblx0XHRcdFx0XHRjb25zdCBmaWxlSW5uZXJFbCA9IHRhcmdldEVsZW1lbnQ/LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ0cmVlLWl0ZW0taW5uZXJcIilbMF0gYXMgSFRNTEVsZW1lbnQ7XHJcblx0XHRcdFx0XHRjb25zdCBpbm5lclRleHQgPSBmaWxlSW5uZXJFbC5pbm5lclRleHQ7XHJcblx0XHRcdFx0XHRjb25zdCBmaWxlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QoaW5uZXJUZXh0LCBcIlwiKTtcclxuXHJcblx0XHRcdFx0XHRpZihmaWxlKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGl0ZW0gPSBjdXJyZW50Vmlldy5kb20ucmVzdWx0RG9tTG9va3VwLmdldChmaWxlKTtcclxuXHRcdFx0XHRcdFx0Y3VycmVudFZpZXcuZG9tLnNldEZvY3VzZWRJdGVtKGl0ZW0pO1xyXG5cdFx0XHRcdFx0XHR0aGlzLmluaXRGaWxlVmlldyhmaWxlLCB1bmRlZmluZWQpO1xyXG5cdFx0XHRcdFx0XHQodGhpcy5zZWFyY2hMZWFmLnZpZXcgYXMgU2VhcmNoVmlldykuc2VhcmNoQ29tcG9uZW50LmlucHV0RWwuZm9jdXMoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIGluaXRGaWxlVmlldyhmaWxlOiBURmlsZSwgc3RhdGU6IGFueSkge1xyXG5cdFx0aWYodGhpcy5maWxlTGVhZikge1xyXG5cdFx0XHRhd2FpdCB0aGlzLmZpbGVMZWFmLm9wZW5GaWxlKGZpbGUsIHtcclxuXHRcdFx0XHRhY3RpdmU6IGZhbHNlLFxyXG5cdFx0XHRcdGVTdGF0ZTogc3RhdGVcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRpZih0aGlzLmZpbGVTdGF0ZT8ubWF0Y2g/Lm1hdGNoZXNbMF0gPT09IHN0YXRlPy5tYXRjaD8ubWF0Y2hlc1swXSAmJiBzdGF0ZSAmJiB0aGlzLmZpbGVTdGF0ZSkge1xyXG5cdFx0XHRcdHNldFRpbWVvdXQoKCk9PntcclxuXHRcdFx0XHRcdGlmKHRoaXMuZmlsZUxlYWYpIHtcclxuXHRcdFx0XHRcdFx0YXBwLndvcmtzcGFjZS5zZXRBY3RpdmVMZWFmKHRoaXMuZmlsZUxlYWYsIHtcclxuXHRcdFx0XHRcdFx0XHRmb2N1czogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSwgMCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5maWxlU3RhdGUgPSBzdGF0ZTtcclxuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0XHRcdCh0aGlzLnNlYXJjaExlYWYudmlldyBhcyBTZWFyY2hWaWV3KS5zZWFyY2hDb21wb25lbnQuaW5wdXRFbC5mb2N1cygpO1xyXG5cdFx0XHRcdH0sIDApO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHR0aGlzLmZpbGVFbCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiZmxvYXQtc2VhcmNoLW1vZGFsLWZpbGUtY3RuXCIgfSk7XHJcblx0XHR0aGlzLm1vZGFsRWwudG9nZ2xlQ2xhc3MoXCJmbG9hdC1zZWFyY2gtd2lkdGhcIiwgdHJ1ZSk7XHJcblx0XHR0aGlzLmZpbGVFbC5vbmtleWRvd24gPSAoZSkgPT4ge1xyXG5cdFx0XHRpZihlLmN0cmxLZXkgJiYgZS5rZXkgPT09IFwiZ1wiKSB7XHJcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG5cdFx0XHRcdCh0aGlzLnNlYXJjaExlYWYudmlldyBhcyBTZWFyY2hWaWV3KS5zZWFyY2hDb21wb25lbnQuaW5wdXRFbC5mb2N1cygpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZihlLmtleSA9PT0gXCJUYWJcIiAmJiBlLmN0cmxLZXkpIHtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcblx0XHRcdFx0KHRoaXMuc2VhcmNoTGVhZi52aWV3IGFzIFNlYXJjaFZpZXcpLnNlYXJjaENvbXBvbmVudC5pbnB1dEVsLmZvY3VzKCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZighdGhpcy5maWxlRWwpIHJldHVybjtcclxuXHJcblx0XHRjb25zdCBbY3JlYXRlZExlYWYsIGVtYmVkZGVkVmlld10gPSBzcGF3bkxlYWZWaWV3KHRoaXMucGx1Z2luLCB0aGlzLmZpbGVFbCk7XHJcblx0XHR0aGlzLmZpbGVMZWFmID0gY3JlYXRlZExlYWY7XHJcblx0XHR0aGlzLmZpbGVFbWJlZGRlZFZpZXcgPSBlbWJlZGRlZFZpZXc7XHJcblxyXG5cdFx0dGhpcy5maWxlTGVhZi5zZXRQaW5uZWQodHJ1ZSk7XHJcblx0XHRhd2FpdCB0aGlzLmZpbGVMZWFmLm9wZW5GaWxlKGZpbGUsIHtcclxuXHRcdFx0YWN0aXZlOiBmYWxzZSxcclxuXHRcdFx0ZVN0YXRlOiBzdGF0ZVxyXG5cdFx0fSk7XHJcblx0XHR0aGlzLmZpbGVTdGF0ZSA9IHN0YXRlO1xyXG5cclxuXHRcdCh0aGlzLnNlYXJjaExlYWYudmlldyBhcyBTZWFyY2hWaWV3KS5zZWFyY2hDb21wb25lbnQuaW5wdXRFbC5mb2N1cygpO1xyXG5cclxuXHR9XHJcbn1cclxuIiwgIi8vIE9yaWdpbmFsIGNvZGUgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vbm90aGluZ2lzbG9zdC9vYnNpZGlhbi1ob3Zlci1lZGl0b3IvYmxvYi85ZWMzNDQ5YmU5YWIzNDMzZGM0NmM0YzNhY2ZkZTFkYTcyZmYwMjYxL3NyYy9wb3BvdmVyLnRzXHJcbi8vIFlvdSBjYW4gdXNlIHRoaXMgZmlsZSBhcyBhIGJhc2ljIGxlYWYgdmlldyBjcmVhdGUgbWV0aG9kIGluIGFueXdoZXJlXHJcbi8vIFBsZWFzZSByZW1lbWViZXIgaWYgeW91IHdhbnQgdG8gdXNlIHRoaXMgZmlsZSwgeW91IHNob3VsZCBwYXRjaCB0aGUgdHlwZXMtb2JzaWRpYW4uZC50cyBmaWxlXHJcbi8vIEFuZCBhbHNvIG1vbmtleSBhcm91bmQgdGhlIE9ic2lkaWFuIG9yaWdpbmFsIG1ldGhvZC5cclxuaW1wb3J0IHtcclxuICAgIENvbXBvbmVudCxcclxuXHRFcGhlbWVyYWxTdGF0ZSxcclxuICAgIEhvdmVyUG9wb3ZlcixcclxuICAgIE1hcmtkb3duRWRpdFZpZXcsXHJcbiAgICBwYXJzZUxpbmt0ZXh0LFxyXG4gICAgUG9wb3ZlclN0YXRlLFxyXG4gICAgcmVxdWlyZUFwaVZlcnNpb24sXHJcbiAgICByZXNvbHZlU3VicGF0aCxcclxuICAgIFRGaWxlLFxyXG4gICAgVmlldyxcclxuICAgIFdvcmtzcGFjZSxcclxuICAgIFdvcmtzcGFjZUxlYWYsXHJcbiAgICBXb3Jrc3BhY2VTcGxpdCxcclxuICAgIFdvcmtzcGFjZVRhYnMsXHJcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB0eXBlIHsgT3BlblZpZXdTdGF0ZSB9IGZyb20gXCJzcmMvdHlwZXMvdHlwZXMtb2JzaWRpYW5cIjtcclxuaW1wb3J0IHR5cGUgRmxvYXRTZWFyY2hQbHVnaW4gZnJvbSBcInNyYy9mbG9hdFNlYXJjaEluZGV4XCI7XHJcblxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFbWJlZGRlZFZpZXdQYXJlbnQge1xyXG4gICAgaG92ZXJQb3BvdmVyOiBFbWJlZGRlZFZpZXcgfCBudWxsO1xyXG4gICAgY29udGFpbmVyRWw/OiBIVE1MRWxlbWVudDtcclxuICAgIHZpZXc/OiBWaWV3O1xyXG4gICAgZG9tPzogSFRNTEVsZW1lbnQ7XHJcbn1cclxuY29uc3QgcG9wb3ZlcnMgPSBuZXcgV2Vha01hcDxFbGVtZW50LCBFbWJlZGRlZFZpZXc+KCk7XHJcbnR5cGUgQ29uc3RydWN0YWJsZVdvcmtzcGFjZVNwbGl0ID0gbmV3ICh3czogV29ya3NwYWNlLCBkaXI6IFwiaG9yaXpvbnRhbFwifFwidmVydGljYWxcIikgPT4gV29ya3NwYWNlU3BsaXQ7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNFbWViZWRkZWRMZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYpIHtcclxuICAgIC8vIFdvcmsgYXJvdW5kIG1pc3NpbmcgZW5oYW5jZS5qcyBBUEkgYnkgY2hlY2tpbmcgbWF0Y2ggY29uZGl0aW9uIGluc3RlYWQgb2YgbG9va2luZyB1cCBwYXJlbnRcclxuICAgIHJldHVybiBsZWFmLmNvbnRhaW5lckVsLm1hdGNoZXMoXCIuZnMtYmxvY2suZnMtbGVhZi12aWV3IC53b3Jrc3BhY2UtbGVhZlwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2VuSWQoc2l6ZTogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IGNoYXJzID0gW107XHJcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHNpemU7IG4rKykgY2hhcnMucHVzaCgoKDE2ICogTWF0aC5yYW5kb20oKSkgfCAwKS50b1N0cmluZygxNikpO1xyXG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oXCJcIik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vc3VwZXI8VD4oYmFzZTogbmV3ICguLi5hcmdzOiB1bmtub3duW10pID0+IFQpOiBuZXcgKCkgPT4gVCB7XHJcbiAgICBjb25zdCBkZXJpdmVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YobmV3IENvbXBvbmVudCwgbmV3LnRhcmdldC5wcm90b3R5cGUpO1xyXG4gICAgfTtcclxuICAgIGRlcml2ZWQucHJvdG90eXBlID0gYmFzZS5wcm90b3R5cGU7XHJcbiAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKGRlcml2ZWQsIGJhc2UpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3Qgc3Bhd25MZWFmVmlldyA9IChwbHVnaW46IEZsb2F0U2VhcmNoUGx1Z2luLCBpbml0aWF0aW5nRWw/OiBIVE1MRWxlbWVudCwgbGVhZj86IFdvcmtzcGFjZUxlYWYsIG9uU2hvd0NhbGxiYWNrPzogKCkgPT4gdW5rbm93bik6IFtXb3Jrc3BhY2VMZWFmLCBFbWJlZGRlZFZpZXddID0+IHtcclxuICAgIC8vIFdoZW4gT2JzaWRpYW4gZG9lc24ndCBzZXQgYW55IGxlYWYgYWN0aXZlLCB1c2UgbGVhZiBpbnN0ZWFkLlxyXG4gICAgbGV0IHBhcmVudCA9IGFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZiBhcyB1bmtub3duIGFzIEVtYmVkZGVkVmlld1BhcmVudDtcclxuICAgIGlmICghcGFyZW50KSBwYXJlbnQgPSBsZWFmIGFzIHVua25vd24gYXMgRW1iZWRkZWRWaWV3UGFyZW50O1xyXG5cclxuICAgIGlmICghaW5pdGlhdGluZ0VsKSBpbml0aWF0aW5nRWwgPSBwYXJlbnQ/LmNvbnRhaW5lckVsO1xyXG5cclxuICAgIGNvbnN0IGhvdmVyUG9wb3ZlciA9IG5ldyBFbWJlZGRlZFZpZXcocGFyZW50LCBpbml0aWF0aW5nRWwhLCBwbHVnaW4sIHVuZGVmaW5lZCwgb25TaG93Q2FsbGJhY2spO1xyXG4gICAgcmV0dXJuIFtob3ZlclBvcG92ZXIuYXR0YWNoTGVhZigpLCBob3ZlclBvcG92ZXJdO1xyXG5cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEVtYmVkZGVkVmlldyBleHRlbmRzIG5vc3VwZXIoSG92ZXJQb3BvdmVyKSB7XHJcbiAgICBvblRhcmdldDogYm9vbGVhbjtcclxuICAgIHNldEFjdGl2ZTogKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xyXG5cclxuICAgIGxvY2tlZE91dDogYm9vbGVhbjtcclxuICAgIGFib3J0Q29udHJvbGxlcj8gPSB0aGlzLmFkZENoaWxkKG5ldyBDb21wb25lbnQoKSk7XHJcbiAgICBkZXRhY2hpbmcgPSBmYWxzZTtcclxuICAgIG9wZW5pbmcgPSBmYWxzZTtcclxuXHJcbiAgICByb290U3BsaXQ6IFdvcmtzcGFjZVNwbGl0ID0gbmV3IChXb3Jrc3BhY2VTcGxpdCBhcyBDb25zdHJ1Y3RhYmxlV29ya3NwYWNlU3BsaXQpKHdpbmRvdy5hcHAud29ya3NwYWNlLCBcInZlcnRpY2FsXCIpO1xyXG5cclxuICAgIGlzUGlubmVkID0gdHJ1ZTtcclxuXHJcbiAgICB0aXRsZUVsOiBIVE1MRWxlbWVudDtcclxuICAgIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudDtcclxuXHJcbiAgICAvLyBJdCBpcyBjdXJyZW50bHkgbm90IHVzZWZ1bC5cclxuICAgIC8vIGxlYWZJbkhvdmVyRWw6IFdvcmtzcGFjZUxlYWY7XHJcblxyXG4gICAgb2xkUG9wb3ZlciA9IHRoaXMucGFyZW50Py5ob3ZlclBvcG92ZXI7XHJcbiAgICBkb2N1bWVudDogRG9jdW1lbnQgPSB0aGlzLnRhcmdldEVsPy5vd25lckRvY3VtZW50ID8/IHdpbmRvdy5hY3RpdmVEb2N1bWVudCA/PyB3aW5kb3cuZG9jdW1lbnQ7XHJcblxyXG4gICAgaWQgPSBnZW5JZCg4KTtcclxuICAgIGJvdW5jZT86IE5vZGVKUy5UaW1lb3V0O1xyXG4gICAgYm91bmRPblpvb21PdXQ6ICgpID0+IHZvaWQ7XHJcblxyXG4gICAgb3JpZ2luYWxQYXRoOiBzdHJpbmc7IC8vIHRoZXNlIGFyZSBrZXB0IHRvIGF2b2lkIGFkb3B0aW5nIHRhcmdldHMgdy9hIGRpZmZlcmVudCBsaW5rXHJcbiAgICBvcmlnaW5hbExpbmtUZXh0OiBzdHJpbmc7XHJcbiAgICBzdGF0aWMgYWN0aXZlUG9wb3Zlcj86IEVtYmVkZGVkVmlldztcclxuXHJcbiAgICBzdGF0aWMgYWN0aXZlV2luZG93cygpIHtcclxuICAgICAgICBjb25zdCB3aW5kb3dzOiBXaW5kb3dbXSA9IFt3aW5kb3ddO1xyXG4gICAgICAgIGNvbnN0IHsgZmxvYXRpbmdTcGxpdCB9ID0gYXBwLndvcmtzcGFjZTtcclxuICAgICAgICBpZiAoZmxvYXRpbmdTcGxpdCkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHNwbGl0IG9mIGZsb2F0aW5nU3BsaXQuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChzcGxpdC53aW4pIHdpbmRvd3MucHVzaChzcGxpdC53aW4pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB3aW5kb3dzO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBjb250YWluZXJGb3JEb2N1bWVudChkb2M6IERvY3VtZW50KSB7XHJcbiAgICAgICAgaWYgKGRvYyAhPT0gZG9jdW1lbnQgJiYgYXBwLndvcmtzcGFjZS5mbG9hdGluZ1NwbGl0KVxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvbnRhaW5lciBvZiBhcHAud29ya3NwYWNlLmZsb2F0aW5nU3BsaXQuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb250YWluZXIuZG9jID09PSBkb2MpIHJldHVybiBjb250YWluZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXBwLndvcmtzcGFjZS5yb290U3BsaXQ7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGFjdGl2ZVBvcG92ZXJzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZVdpbmRvd3MoKS5mbGF0TWFwKHRoaXMucG9wb3ZlcnNGb3JXaW5kb3cpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBwb3BvdmVyc0ZvcldpbmRvdyh3aW4/OiBXaW5kb3cpIHtcclxuICAgICAgICByZXR1cm4gKEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHdpbj8uZG9jdW1lbnQ/LmJvZHkucXVlcnlTZWxlY3RvckFsbChcIi5mcy1sZWFmLXZpZXdcIikgPz8gW10pIGFzIEhUTUxFbGVtZW50W10pXHJcbiAgICAgICAgICAgIC5tYXAoZWwgPT4gcG9wb3ZlcnMuZ2V0KGVsKSEpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoaGUgPT4gaGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBmb3JMZWFmKGxlYWY6IFdvcmtzcGFjZUxlYWYgfCB1bmRlZmluZWQpIHtcclxuICAgICAgICAvLyBsZWFmIGNhbiBiZSBudWxsIHN1Y2ggYXMgd2hlbiByaWdodCBjbGlja2luZyBvbiBhbiBpbnRlcm5hbCBsaW5rXHJcbiAgICAgICAgY29uc3QgZWwgPSBsZWFmICYmIGRvY3VtZW50LmJvZHkubWF0Y2hQYXJlbnQuY2FsbChsZWFmLmNvbnRhaW5lckVsLCBcIi5mcy1sZWFmLXZpZXdcIik7IC8vIHdvcmsgYXJvdW5kIG1hdGNoUGFyZW50IHJhY2UgY29uZGl0aW9uXHJcbiAgICAgICAgcmV0dXJuIGVsID8gcG9wb3ZlcnMuZ2V0KGVsKSA6IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgaXRlcmF0ZVBvcG92ZXJMZWF2ZXMod3M6IFdvcmtzcGFjZSwgY2I6IChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiBib29sZWFuIHwgdm9pZCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgcG9wb3ZlciBvZiB0aGlzLmFjdGl2ZVBvcG92ZXJzKCkpIHtcclxuICAgICAgICAgICAgaWYgKHBvcG92ZXIucm9vdFNwbGl0ICYmIHdzLml0ZXJhdGVMZWF2ZXMoY2IsIHBvcG92ZXIucm9vdFNwbGl0KSkgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBob3ZlckVsOiBIVE1MRWxlbWVudCA9IHRoaXMuZG9jdW1lbnQuZGVmYXVsdFZpZXchLmNyZWF0ZURpdih7XHJcbiAgICAgICAgY2xzOiBcImZzLWJsb2NrIGZzLWxlYWYtdmlld1wiLFxyXG4gICAgICAgIGF0dHI6IHsgaWQ6IFwiZnMtXCIgKyB0aGlzLmlkIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwYXJlbnQ6IEVtYmVkZGVkVmlld1BhcmVudCxcclxuICAgICAgICBwdWJsaWMgdGFyZ2V0RWw6IEhUTUxFbGVtZW50LFxyXG4gICAgICAgIHB1YmxpYyBwbHVnaW46IEZsb2F0U2VhcmNoUGx1Z2luLFxyXG4gICAgICAgIHdhaXRUaW1lPzogbnVtYmVyLFxyXG4gICAgICAgIHB1YmxpYyBvblNob3dDYWxsYmFjaz86ICgpID0+IHVua25vd24sXHJcbiAgICApIHtcclxuICAgICAgICAvL1xyXG4gICAgICAgIHN1cGVyKCk7XHJcblxyXG4gICAgICAgIGlmICh3YWl0VGltZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdhaXRUaW1lID0gMzAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9uVGFyZ2V0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XHJcbiAgICAgICAgdGhpcy53YWl0VGltZSA9IHdhaXRUaW1lO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBQb3BvdmVyU3RhdGUuU2hvd2luZztcclxuICAgICAgICBjb25zdCB7IGhvdmVyRWwgfSA9IHRoaXM7XHJcblxyXG4gICAgICAgIHRoaXMuYWJvcnRDb250cm9sbGVyIS5sb2FkKCk7XHJcbiAgICAgICAgdGhpcy5zaG93KCk7XHJcbiAgICAgICAgdGhpcy5vblNob3coKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRBY3RpdmUgPSB0aGlzLl9zZXRBY3RpdmUuYmluZCh0aGlzKTtcclxuICAgICAgICAvLyBpZiAoaG92ZXJFbCkge1xyXG4gICAgICAgIC8vICAgICBob3ZlckVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5zZXRBY3RpdmUpO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyBjdXN0b20gbG9naWMgYmVnaW5cclxuICAgICAgICBwb3BvdmVycy5zZXQodGhpcy5ob3ZlckVsLCB0aGlzKTtcclxuICAgICAgICB0aGlzLmhvdmVyRWwuYWRkQ2xhc3MoXCJmcy1ibG9ja1wiKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsID0gdGhpcy5ob3ZlckVsLmNyZWF0ZURpdihcImZzLWNvbnRlbnRcIik7XHJcbiAgICAgICAgdGhpcy5idWlsZFdpbmRvd0NvbnRyb2xzKCk7XHJcbiAgICAgICAgdGhpcy5zZXRJbml0aWFsRGltZW5zaW9ucygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRBY3RpdmUoZXZ0OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZih0aGlzLmxlYXZlcygpWzBdLCB7Zm9jdXM6IHRydWV9KVxyXG4gICAgfVxyXG5cclxuICAgIGdldERlZmF1bHRNb2RlKCkge1xyXG4gICAgICAgIC8vIHJldHVybiB0aGlzLnBhcmVudD8udmlldz8uZ2V0TW9kZSA/IHRoaXMucGFyZW50LnZpZXcuZ2V0TW9kZSgpIDogXCJzb3VyY2VcIjtcclxuICAgICAgICByZXR1cm4gXCJzb3VyY2VcIjtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVMZWF2ZXMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMub25UYXJnZXQgJiYgdGhpcy50YXJnZXRFbCAmJiAhdGhpcy5kb2N1bWVudC5jb250YWlucyh0aGlzLnRhcmdldEVsKSkge1xyXG4gICAgICAgICAgICB0aGlzLm9uVGFyZ2V0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbGVhZkNvdW50ID0gMDtcclxuICAgICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLml0ZXJhdGVMZWF2ZXMobGVhZiA9PiB7XHJcbiAgICAgICAgICAgIGxlYWZDb3VudCsrO1xyXG4gICAgICAgIH0sIHRoaXMucm9vdFNwbGl0KTtcclxuXHJcbiAgICAgICAgaWYgKGxlYWZDb3VudCA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmhpZGUoKTsgLy8gY2xvc2UgaWYgd2UgaGF2ZSBubyBsZWF2ZXNcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ob3ZlckVsLnNldEF0dHJpYnV0ZShcImRhdGEtbGVhZi1jb3VudFwiLCBsZWFmQ291bnQudG9TdHJpbmcoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGVhdmVzKCkge1xyXG4gICAgICAgIGNvbnN0IGxlYXZlczogV29ya3NwYWNlTGVhZltdID0gW107XHJcbiAgICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5pdGVyYXRlTGVhdmVzKGxlYWYgPT4ge1xyXG4gICAgICAgICAgICBsZWF2ZXMucHVzaChsZWFmKTtcclxuICAgICAgICB9LCB0aGlzLnJvb3RTcGxpdCk7XHJcbiAgICAgICAgcmV0dXJuIGxlYXZlcztcclxuICAgIH1cclxuXHJcbiAgICBzZXRJbml0aWFsRGltZW5zaW9ucygpIHtcclxuXHJcbiAgICAgICAgdGhpcy5ob3ZlckVsLnN0eWxlLmhlaWdodCA9ICdhdXRvJztcclxuICAgICAgICB0aGlzLmhvdmVyRWwuc3R5bGUud2lkdGggPSBcIjEwMCVcIjtcclxuICAgIH1cclxuXHJcbiAgICB0cmFuc2l0aW9uKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZFNob3coKSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gUG9wb3ZlclN0YXRlLkhpZGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IFBvcG92ZXJTdGF0ZS5TaG93bjtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXRlID09PSBQb3BvdmVyU3RhdGUuU2hvd2luZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0ZSA9PT0gUG9wb3ZlclN0YXRlLlNob3duKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IFBvcG92ZXJTdGF0ZS5IaWRpbmc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2hvdWxkU2hvdygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyYW5zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcy53YWl0VGltZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG5cclxuICAgIGJ1aWxkV2luZG93Q29udHJvbHMoKSB7XHJcbiAgICAgICAgdGhpcy50aXRsZUVsID0gdGhpcy5kb2N1bWVudC5kZWZhdWx0VmlldyEuY3JlYXRlRGl2KFwicG9wb3Zlci10aXRsZWJhclwiKTtcclxuICAgICAgICB0aGlzLnRpdGxlRWwuY3JlYXRlRGl2KFwicG9wb3Zlci10aXRsZVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5wcmVwZW5kKHRoaXMudGl0bGVFbCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGF0dGFjaExlYWYoKTogV29ya3NwYWNlTGVhZiB7XHJcbiAgICAgICAgdGhpcy5yb290U3BsaXQuZ2V0Um9vdCA9ICgpID0+IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2VbdGhpcy5kb2N1bWVudCA9PT0gZG9jdW1lbnQgPyBcInJvb3RTcGxpdFwiIDogXCJmbG9hdGluZ1NwbGl0XCJdITtcclxuICAgICAgICB0aGlzLnJvb3RTcGxpdC5nZXRDb250YWluZXIgPSAoKSA9PiBFbWJlZGRlZFZpZXcuY29udGFpbmVyRm9yRG9jdW1lbnQodGhpcy5kb2N1bWVudCk7XHJcblxyXG4gICAgICAgIHRoaXMudGl0bGVFbC5pbnNlcnRBZGphY2VudEVsZW1lbnQoXCJhZnRlcmVuZFwiLCB0aGlzLnJvb3RTcGxpdC5jb250YWluZXJFbCk7XHJcbiAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuY3JlYXRlTGVhZkluUGFyZW50KHRoaXMucm9vdFNwbGl0LCAwKTtcclxuXHJcbiAgICAgICAgdGhpcy51cGRhdGVMZWF2ZXMoKTtcclxuICAgICAgICByZXR1cm4gbGVhZjtcclxuICAgIH1cclxuXHJcbiAgICBvbmxvYWQoKTogdm9pZCB7XHJcbiAgICAgICAgc3VwZXIub25sb2FkKCk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oXCJsYXlvdXQtY2hhbmdlXCIsIHRoaXMudXBkYXRlTGVhdmVzLCB0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KGFwcC53b3Jrc3BhY2Uub24oXCJsYXlvdXQtY2hhbmdlXCIsICgpID0+IHtcclxuICAgICAgICAgICAgLy8gRW5zdXJlIHRoYXQgdG9wLWxldmVsIGl0ZW1zIGluIGEgcG9wb3ZlciBhcmUgbm90IHRhYmJlZFxyXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXHJcbiAgICAgICAgICAgIHRoaXMucm9vdFNwbGl0LmNoaWxkcmVuLmZvckVhY2goKGl0ZW06IGFueSwgaW5kZXg6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0gaW5zdGFuY2VvZiBXb3Jrc3BhY2VUYWJzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290U3BsaXQucmVwbGFjZUNoaWxkKGluZGV4LCBpdGVtLmNoaWxkcmVuWzBdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25TaG93KCkge1xyXG4gICAgICAgIC8vIE9uY2Ugd2UndmUgYmVlbiBvcGVuIGZvciBjbG9zZURlbGF5LCB1c2UgdGhlIGNsb3NlRGVsYXkgYXMgYSBoaWRpbmcgdGltZW91dFxyXG4gICAgICAgIGNvbnN0IGNsb3NlRGVsYXkgPSA2MDA7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiAodGhpcy53YWl0VGltZSA9IGNsb3NlRGVsYXkpLCBjbG9zZURlbGF5KTtcclxuXHJcbiAgICAgICAgdGhpcy5vbGRQb3BvdmVyPy5oaWRlKCk7XHJcbiAgICAgICAgdGhpcy5vbGRQb3BvdmVyID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5ob3ZlckVsLnRvZ2dsZUNsYXNzKFwiaXMtbmV3XCIsIHRydWUpO1xyXG5cclxuICAgICAgICB0aGlzLmRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgICAgICAgXCJjbGlja1wiLFxyXG4gICAgICAgICAgICAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhvdmVyRWwudG9nZ2xlQ2xhc3MoXCJpcy1uZXdcIiwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7IG9uY2U6IHRydWUsIGNhcHR1cmU6IHRydWUgfSxcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuaG92ZXJQb3BvdmVyID0gdGhpcztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFJlbW92ZSBvcmlnaW5hbCB2aWV3IGhlYWRlcjtcclxuICAgICAgICBjb25zdCB2aWV3SGVhZGVyRWwgPSB0aGlzLmhvdmVyRWwucXVlcnlTZWxlY3RvcihcIi52aWV3LWhlYWRlclwiKTtcclxuICAgICAgICB2aWV3SGVhZGVyRWw/LnJlbW92ZSgpO1xyXG5cclxuICAgICAgICBjb25zdCBzaXplciA9IHRoaXMuaG92ZXJFbC5xdWVyeVNlbGVjdG9yKFwiLndvcmtzcGFjZS1sZWFmXCIpO1xyXG4gICAgICAgIGlmKHNpemVyKSB0aGlzLmhvdmVyRWwuYXBwZW5kQ2hpbGQoc2l6ZXIpO1xyXG5cclxuICAgICAgICAvLyBSZW1vdmUgb3JpZ2luYWwgaW5saW5lIHRpbHRlO1xyXG4gICAgICAgIGNvbnN0IGlubGluZVRpdGxlID0gdGhpcy5ob3ZlckVsLnF1ZXJ5U2VsZWN0b3IoXCIuaW5saW5lLXRpdGxlXCIpO1xyXG4gICAgICAgIGlmKGlubGluZVRpdGxlKSBpbmxpbmVUaXRsZS5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5vblNob3dDYWxsYmFjaz8uKCk7XHJcbiAgICAgICAgdGhpcy5vblNob3dDYWxsYmFjayA9IHVuZGVmaW5lZDsgLy8gb25seSBjYWxsIGl0IG9uY2VcclxuICAgIH1cclxuXHJcbiAgICBkZXRlY3QoZWw6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgLy8gVE9ETzogbWF5IG5vdCBiZSBuZWVkZWQ/IHRoZSBtb3VzZW92ZXIvb3V0IGhhbmRlcnMgaGFuZGxlIG1vc3QgZGV0ZWN0aW9uIHVzZSBjYXNlc1xyXG4gICAgICAgIGNvbnN0IHsgdGFyZ2V0RWwgfSA9IHRoaXM7XHJcblxyXG4gICAgICAgIGlmICh0YXJnZXRFbCkge1xyXG4gICAgICAgICAgICB0aGlzLm9uVGFyZ2V0ID0gZWwgPT09IHRhcmdldEVsIHx8IHRhcmdldEVsLmNvbnRhaW5zKGVsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2hvdWxkU2hvdygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zaG91bGRTaG93U2VsZigpIHx8IHRoaXMuc2hvdWxkU2hvd0NoaWxkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc2hvdWxkU2hvd0NoaWxkKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBFbWJlZGRlZFZpZXcuYWN0aXZlUG9wb3ZlcnMoKS5zb21lKHBvcG92ZXIgPT4ge1xyXG4gICAgICAgICAgICBpZiAocG9wb3ZlciAhPT0gdGhpcyAmJiBwb3BvdmVyLnRhcmdldEVsICYmIHRoaXMuaG92ZXJFbC5jb250YWlucyhwb3BvdmVyLnRhcmdldEVsKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHBvcG92ZXIuc2hvdWxkU2hvdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzaG91bGRTaG93U2VsZigpIHtcclxuICAgICAgICAvLyBEb24ndCBsZXQgb2JzaWRpYW4gc2hvdygpIHVzIGlmIHdlJ3ZlIGFscmVhZHkgc3RhcnRlZCBjbG9zaW5nXHJcbiAgICAgICAgLy8gcmV0dXJuICF0aGlzLmRldGFjaGluZyAmJiAodGhpcy5vblRhcmdldCB8fCB0aGlzLm9uSG92ZXIpO1xyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgICF0aGlzLmRldGFjaGluZyAmJlxyXG4gICAgICAgICAgICAhIShcclxuICAgICAgICAgICAgICAgIHRoaXMub25UYXJnZXQgfHxcclxuICAgICAgICAgICAgICAgICh0aGlzLnN0YXRlID09IFBvcG92ZXJTdGF0ZS5TaG93bikgfHxcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgYm9keT4ubW9kYWwtY29udGFpbmVyLCBib2R5ID4gI2hlJHt0aGlzLmlkfSB+IC5tZW51LCBib2R5ID4gI2hlJHt0aGlzLmlkfSB+IC5zdWdnZXN0aW9uLWNvbnRhaW5lcmApXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHNob3coKSB7XHJcbiAgICAgICAgLy8gbmF0aXZlIG9ic2lkaWFuIGxvZ2ljIHN0YXJ0XHJcbiAgICAgICAgLy8gaWYgKCF0aGlzLnRhcmdldEVsIHx8IHRoaXMuZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLnRhcmdldEVsKSkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gUG9wb3ZlclN0YXRlLlNob3duO1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyID0gMDtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0RWwuYXBwZW5kQ2hpbGQodGhpcy5ob3ZlckVsKTtcclxuICAgICAgICAgICAgdGhpcy5vblNob3coKTtcclxuICAgICAgICAgICAgYXBwLndvcmtzcGFjZS5vbkxheW91dENoYW5nZSgpO1xyXG5cclxuICAgICAgICAgICAgLy8gaW5pdGlhbGl6aW5nSG92ZXJQb3BvdmVycy5yZW1vdmUodGhpcyk7XHJcbiAgICAgICAgICAgIC8vIGFjdGl2ZUhvdmVyUG9wb3ZlcnMucHVzaCh0aGlzKTtcclxuICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZVBvcG92ZXJDaGVja2VyKCk7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZCgpO1xyXG4gICAgICAgIC8vIH1cclxuICAgICAgICAvLyBuYXRpdmUgb2JzaWRpYW4gbG9naWMgZW5kXHJcblxyXG4gICAgICAgIC8vIGlmIHRoaXMgaXMgYW4gaW1hZ2Ugdmlldywgc2V0IHRoZSBkaW1lbnNpb25zIHRvIHRoZSBuYXR1cmFsIGRpbWVuc2lvbnMgb2YgdGhlIGltYWdlXHJcbiAgICAgICAgLy8gYW4gaW50ZXJhY3RqcyByZWZsb3cgd2lsbCBiZSB0cmlnZ2VyZWQgdG8gY29uc3RyYWluIHRoZSBpbWFnZSB0byB0aGUgdmlld3BvcnQgaWYgaXQnc1xyXG4gICAgICAgIC8vIHRvbyBsYXJnZVxyXG4gICAgICAgIGlmICh0aGlzLmhvdmVyRWwuZGF0YXNldC5pbWdIZWlnaHQgJiYgdGhpcy5ob3ZlckVsLmRhdGFzZXQuaW1nV2lkdGgpIHtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlckVsLnN0eWxlLmhlaWdodCA9IHBhcnNlRmxvYXQodGhpcy5ob3ZlckVsLmRhdGFzZXQuaW1nSGVpZ2h0KSArIHRoaXMudGl0bGVFbC5vZmZzZXRIZWlnaHQgKyBcInB4XCI7XHJcbiAgICAgICAgICAgIHRoaXMuaG92ZXJFbC5zdHlsZS53aWR0aCA9IHBhcnNlRmxvYXQodGhpcy5ob3ZlckVsLmRhdGFzZXQuaW1nV2lkdGgpICsgXCJweFwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvbkhpZGUoKSB7XHJcbiAgICAgICAgdGhpcy5vbGRQb3BvdmVyID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5wYXJlbnQ/LmhvdmVyUG9wb3ZlciA9PT0gdGhpcykge1xyXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5ob3ZlclBvcG92ZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBoaWRlKCkge1xyXG4gICAgICAgIHRoaXMub25UYXJnZXQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmRldGFjaGluZyA9IHRydWU7XHJcbiAgICAgICAgLy8gT25jZSB3ZSByZWFjaCB0aGlzIHBvaW50LCB3ZSdyZSBjb21taXR0ZWQgdG8gY2xvc2luZ1xyXG5cclxuICAgICAgICAvLyBpbiBjYXNlIHdlIGRpZG4ndCBldmVyIGNhbGwgc2hvdygpXHJcblxyXG5cclxuICAgICAgICAvLyBBIHRpbWVyIG1pZ2h0IGJlIHBlbmRpbmcgdG8gY2FsbCBzaG93KCkgZm9yIHRoZSBmaXJzdCB0aW1lLCBtYWtlIHN1cmVcclxuICAgICAgICAvLyBpdCBkb2Vzbid0IGJyaW5nIHVzIGJhY2sgdXAgYWZ0ZXIgd2UgY2xvc2VcclxuICAgICAgICBpZiAodGhpcy50aW1lcikge1xyXG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXIgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gSGlkZSBvdXIgSFRNTCBlbGVtZW50IGltbWVkaWF0ZWx5LCBldmVuIGlmIG91ciBsZWF2ZXMgbWlnaHQgbm90IGJlXHJcbiAgICAgICAgLy8gZGV0YWNoYWJsZSB5ZXQuICBUaGlzIG1ha2VzIHRoaW5ncyBtb3JlIHJlc3BvbnNpdmUgYW5kIGltcHJvdmVzIHRoZVxyXG4gICAgICAgIC8vIG9kZHMgb2Ygbm90IHNob3dpbmcgYW4gZW1wdHkgcG9wdXAgdGhhdCdzIGp1c3QgZ29pbmcgdG8gZGlzYXBwZWFyXHJcbiAgICAgICAgLy8gbW9tZW50YXJpbHkuXHJcbiAgICAgICAgdGhpcy5ob3ZlckVsLmhpZGUoKTtcclxuXHJcbiAgICAgICAgLy8gSWYgYSBmaWxlIGxvYWQgaXMgaW4gcHJvZ3Jlc3MsIHdlIG5lZWQgdG8gd2FpdCB1bnRpbCBpdCdzIGZpbmlzaGVkIGJlZm9yZVxyXG4gICAgICAgIC8vIGRldGFjaGluZyBsZWF2ZXMuICBCZWNhdXNlIHdlIHNldCAuZGV0YWNoaW5nLCBUaGUgaW4tcHJvZ3Jlc3Mgb3BlbkZpbGUoKVxyXG4gICAgICAgIC8vIHdpbGwgY2FsbCB1cyBhZ2FpbiB3aGVuIGl0IGZpbmlzaGVzLlxyXG4gICAgICAgIGlmICh0aGlzLm9wZW5pbmcpIHJldHVybjtcclxuXHJcbiAgICAgICAgLy8gTGVhdmUgdGhpcyBjb2RlIGhlcmUgdG8gb2JzZXJ2ZSB0aGUgc3RhdGUgb2YgdGhlIGxlYXZlc1xyXG4gICAgICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMubGVhdmVzKCk7XHJcbiAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgLy8gRGV0YWNoIGFsbCBsZWF2ZXMgYmVmb3JlIHdlIHVubG9hZCB0aGUgcG9wb3ZlciBhbmQgcmVtb3ZlIGl0IGZyb20gdGhlIERPTS5cclxuICAgICAgICAgICAgLy8gRWFjaCBsZWFmLmRldGFjaCgpIHdpbGwgdHJpZ2dlciBsYXlvdXQtY2hhbmdlZCBhbmQgdGhlIHVwZGF0ZUxlYXZlcygpXHJcbiAgICAgICAgICAgIC8vIG1ldGhvZCB3aWxsIHRoZW4gY2FsbCBoaWRlKCkgYWdhaW4gd2hlbiB0aGUgbGFzdCBvbmUgaXMgZ29uZS5cclxuICAgICAgICAgICAgLy8gbGVhdmVzWzBdLmRldGFjaCgpO1xyXG4gICAgICAgICAgICAvLyBsZWF2ZXNbMF0uZGV0YWNoKCk7XHJcbiAgICAgICAgICAgIHRoaXMudGFyZ2V0RWwuZW1wdHkoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMuYWJvcnRDb250cm9sbGVyPy51bmxvYWQoKTtcclxuICAgICAgICAgICAgdGhpcy5hYm9ydENvbnRyb2xsZXIgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZUhpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbmF0aXZlSGlkZSgpIHtcclxuICAgICAgICBjb25zdCB7IGhvdmVyRWwsIHRhcmdldEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBQb3BvdmVyU3RhdGUuSGlkZGVuO1xyXG4gICAgICAgIGhvdmVyRWwuZGV0YWNoKCk7XHJcblxyXG4gICAgICAgIGlmICh0YXJnZXRFbCkge1xyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnQgPSB0YXJnZXRFbC5tYXRjaFBhcmVudChcIi5mcy1sZWFmLXZpZXdcIik7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnQpIHBvcG92ZXJzLmdldChwYXJlbnQpPy50cmFuc2l0aW9uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLm9uSGlkZSgpO1xyXG4gICAgICAgIHRoaXMudW5sb2FkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzb2x2ZUxpbmsobGlua1RleHQ6IHN0cmluZywgc291cmNlUGF0aDogc3RyaW5nKTogVEZpbGUgfCBudWxsIHtcclxuICAgICAgICBjb25zdCBsaW5rID0gcGFyc2VMaW5rdGV4dChsaW5rVGV4dCk7XHJcbiAgICAgICAgY29uc3QgdEZpbGUgPSBsaW5rID8gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QobGluay5wYXRoLCBzb3VyY2VQYXRoKSA6IG51bGw7XHJcbiAgICAgICAgcmV0dXJuIHRGaWxlO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIG9wZW5MaW5rKGxpbmtUZXh0OiBzdHJpbmcsIHNvdXJjZVBhdGg6IHN0cmluZywgZVN0YXRlPzogRXBoZW1lcmFsU3RhdGUsIGNyZWF0ZUluTGVhZj86IFdvcmtzcGFjZUxlYWYpIHtcclxuICAgICAgICBsZXQgZmlsZSA9IHRoaXMucmVzb2x2ZUxpbmsobGlua1RleHQsIHNvdXJjZVBhdGgpO1xyXG4gICAgICAgIGNvbnN0IGxpbmsgPSBwYXJzZUxpbmt0ZXh0KGxpbmtUZXh0KTtcclxuICAgICAgICBpZiAoIWZpbGUgJiYgY3JlYXRlSW5MZWFmKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvbGRlciA9IHRoaXMucGx1Z2luLmFwcC5maWxlTWFuYWdlci5nZXROZXdGaWxlUGFyZW50KHNvdXJjZVBhdGgpO1xyXG4gICAgICAgICAgICBmaWxlID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLmZpbGVNYW5hZ2VyLmNyZWF0ZU5ld01hcmtkb3duRmlsZShmb2xkZXIsIGxpbmsucGF0aCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWZpbGUpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5kaXNwbGF5Q3JlYXRlRmlsZUFjdGlvbihsaW5rVGV4dCwgc291cmNlUGF0aCwgZVN0YXRlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCB7IHZpZXdSZWdpc3RyeSB9ID0gdGhpcy5wbHVnaW4uYXBwO1xyXG4gICAgICAgIGNvbnN0IHZpZXdUeXBlID0gdmlld1JlZ2lzdHJ5LnR5cGVCeUV4dGVuc2lvbltmaWxlLmV4dGVuc2lvbl07XHJcbiAgICAgICAgaWYgKCF2aWV3VHlwZSB8fCAhdmlld1JlZ2lzdHJ5LnZpZXdCeVR5cGVbdmlld1R5cGVdKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMuZGlzcGxheU9wZW5GaWxlQWN0aW9uKGZpbGUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlU3RhdGUgPSBPYmplY3QuYXNzaWduKHRoaXMuYnVpbGRFcGhlbWVyYWxTdGF0ZShmaWxlLCBsaW5rKSwgZVN0YXRlKTtcclxuICAgICAgICBjb25zdCBwYXJlbnRNb2RlID0gdGhpcy5nZXREZWZhdWx0TW9kZSgpO1xyXG4gICAgICAgIGNvbnN0IHN0YXRlID0gdGhpcy5idWlsZFN0YXRlKHBhcmVudE1vZGUsIGVTdGF0ZSk7XHJcbiAgICAgICAgY29uc3QgbGVhZiA9IGF3YWl0IHRoaXMub3BlbkZpbGUoZmlsZSwgc3RhdGUsIGNyZWF0ZUluTGVhZik7XHJcbiAgICAgICAgY29uc3QgbGVhZlZpZXdUeXBlID0gbGVhZj8udmlldz8uZ2V0Vmlld1R5cGUoKTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhsZWFmKTtcclxuICAgICAgICBpZiAobGVhZlZpZXdUeXBlID09PSBcImltYWdlXCIpIHtcclxuICAgICAgICAgICAgLy8gVE9ETzogdGVtcG9yYXJ5IHdvcmthcm91bmQgdG8gcHJldmVudCBpbWFnZSBwb3BvdmVyIGZyb20gZGlzYXBwZWFyaW5nIGltbWVkaWF0ZWx5IHdoZW4gdXNpbmcgbGl2ZSBwcmV2aWV3XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Py5oYXNPd25Qcm9wZXJ0eShcImVkaXRvckVsXCIpICYmXHJcbiAgICAgICAgICAgICAgICAodGhpcy5wYXJlbnQgYXMgdW5rbm93biBhcyBNYXJrZG93bkVkaXRWaWV3KS5lZGl0b3JFbCEuaGFzQ2xhc3MoXCJpcy1saXZlLXByZXZpZXdcIilcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndhaXRUaW1lID0gMzAwMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBpbWcgPSBsZWFmIS52aWV3LmNvbnRlbnRFbC5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpITtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlckVsLmRhdGFzZXQuaW1nSGVpZ2h0ID0gU3RyaW5nKGltZy5uYXR1cmFsSGVpZ2h0KTtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlckVsLmRhdGFzZXQuaW1nV2lkdGggPSBTdHJpbmcoaW1nLm5hdHVyYWxXaWR0aCk7XHJcbiAgICAgICAgICAgIHRoaXMuaG92ZXJFbC5kYXRhc2V0LmltZ1JhdGlvID0gU3RyaW5nKGltZy5uYXR1cmFsV2lkdGggLyBpbWcubmF0dXJhbEhlaWdodCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChsZWFmVmlld1R5cGUgPT09IFwicGRmXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlckVsLnN0eWxlLmhlaWdodCA9IFwiODAwcHhcIjtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlckVsLnN0eWxlLndpZHRoID0gXCI2MDBweFwiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3RhdGUuc3RhdGU/Lm1vZGUgPT09IFwic291cmNlXCIpIHtcclxuICAgICAgICAgICAgdGhpcy53aGVuU2hvd24oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gTm90IHN1cmUgd2h5IHRoaXMgaXMgbmVlZGVkLCBidXQgd2l0aG91dCBpdCB3ZSBnZXQgaXNzdWUgIzE4NlxyXG4gICAgICAgICAgICAgICAgaWYgKHJlcXVpcmVBcGlWZXJzaW9uKFwiMS4wXCIpKShsZWFmPy52aWV3IGFzIGFueSk/LmVkaXRNb2RlPy5yZWluaXQ/LigpO1xyXG4gICAgICAgICAgICAgICAgbGVhZj8udmlldz8uc2V0RXBoZW1lcmFsU3RhdGUoc3RhdGUuZVN0YXRlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHdoZW5TaG93bihjYWxsYmFjazogKCkgPT4gYW55KSB7XHJcbiAgICAgICAgLy8gaW52b2tlIGNhbGxiYWNrIG9uY2UgdGhlIHBvcG92ZXIgaXMgdmlzaWJsZVxyXG4gICAgICAgIGlmICh0aGlzLmRldGFjaGluZykgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQ2FsbGJhY2sgPSB0aGlzLm9uU2hvd0NhbGxiYWNrO1xyXG4gICAgICAgIHRoaXMub25TaG93Q2FsbGJhY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRldGFjaGluZykgcmV0dXJuO1xyXG4gICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGV4aXN0aW5nQ2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikgZXhpc3RpbmdDYWxsYmFjaygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUgPT09IFBvcG92ZXJTdGF0ZS5TaG93bikge1xyXG4gICAgICAgICAgICB0aGlzLm9uU2hvd0NhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIHRoaXMub25TaG93Q2FsbGJhY2sgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIG9wZW5GaWxlKGZpbGU6IFRGaWxlLCBvcGVuU3RhdGU/OiBPcGVuVmlld1N0YXRlLCB1c2VMZWFmPzogV29ya3NwYWNlTGVhZikge1xyXG4gICAgICAgIGlmICh0aGlzLmRldGFjaGluZykgcmV0dXJuO1xyXG4gICAgICAgIGNvbnN0IGxlYWYgPSB1c2VMZWFmID8/IHRoaXMuYXR0YWNoTGVhZigpO1xyXG4gICAgICAgIHRoaXMub3BlbmluZyA9IHRydWU7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUoZmlsZSwgb3BlblN0YXRlKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgfSBmaW5hbGx5IHtcclxuICAgICAgICAgICAgdGhpcy5vcGVuaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmRldGFjaGluZykgdGhpcy5oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihsZWFmKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGxlYWY7XHJcbiAgICB9XHJcblxyXG4gICAgYnVpbGRTdGF0ZShwYXJlbnRNb2RlOiBzdHJpbmcsIGVTdGF0ZT86IEVwaGVtZXJhbFN0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYWN0aXZlOiBmYWxzZSwgLy8gRG9uJ3QgbGV0IE9ic2lkaWFuIGZvcmNlIGZvY3VzIGlmIHdlIGhhdmUgYXV0b2ZvY3VzIG9mZlxyXG4gICAgICAgICAgICBzdGF0ZTogeyBtb2RlOiBcInNvdXJjZVwiIH0sIC8vIERvbid0IHNldCBhbnkgc3RhdGUgZm9yIHRoZSB2aWV3LCBiZWNhdXNlIHRoaXMgbGVhZiBpcyBzdGF5ZWQgb24gYW5vdGhlciB2aWV3LlxyXG4gICAgICAgICAgICBlU3RhdGU6IGVTdGF0ZSxcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkRXBoZW1lcmFsU3RhdGUoXHJcbiAgICAgICAgZmlsZTogVEZpbGUsXHJcbiAgICAgICAgbGluaz86IHtcclxuICAgICAgICAgICAgcGF0aDogc3RyaW5nO1xyXG4gICAgICAgICAgICBzdWJwYXRoOiBzdHJpbmc7XHJcbiAgICAgICAgfSxcclxuICAgICkge1xyXG4gICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgIGNvbnN0IHN1YnBhdGggPSBjYWNoZSA/IHJlc29sdmVTdWJwYXRoKGNhY2hlLCBsaW5rPy5zdWJwYXRoIHx8IFwiXCIpIDogdW5kZWZpbmVkO1xyXG4gICAgICAgIGNvbnN0IGVTdGF0ZTogRXBoZW1lcmFsU3RhdGUgPSB7IHN1YnBhdGg6IGxpbms/LnN1YnBhdGggfTtcclxuICAgICAgICBpZiAoc3VicGF0aCkge1xyXG4gICAgICAgICAgICBlU3RhdGUubGluZSA9IHN1YnBhdGguc3RhcnQubGluZTtcclxuICAgICAgICAgICAgZVN0YXRlLnN0YXJ0TG9jID0gc3VicGF0aC5zdGFydDtcclxuICAgICAgICAgICAgZVN0YXRlLmVuZExvYyA9IHN1YnBhdGguZW5kIHx8IHVuZGVmaW5lZDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGVTdGF0ZTtcclxuICAgIH1cclxufVxyXG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGFyb3VuZChvYmosIGZhY3Rvcmllcykge1xuICAgIGNvbnN0IHJlbW92ZXJzID0gT2JqZWN0LmtleXMoZmFjdG9yaWVzKS5tYXAoa2V5ID0+IGFyb3VuZDEob2JqLCBrZXksIGZhY3Rvcmllc1trZXldKSk7XG4gICAgcmV0dXJuIHJlbW92ZXJzLmxlbmd0aCA9PT0gMSA/IHJlbW92ZXJzWzBdIDogZnVuY3Rpb24gKCkgeyByZW1vdmVycy5mb3JFYWNoKHIgPT4gcigpKTsgfTtcbn1cbmZ1bmN0aW9uIGFyb3VuZDEob2JqLCBtZXRob2QsIGNyZWF0ZVdyYXBwZXIpIHtcbiAgICBjb25zdCBvcmlnaW5hbCA9IG9ialttZXRob2RdLCBoYWRPd24gPSBvYmouaGFzT3duUHJvcGVydHkobWV0aG9kKTtcbiAgICBsZXQgY3VycmVudCA9IGNyZWF0ZVdyYXBwZXIob3JpZ2luYWwpO1xuICAgIC8vIExldCBvdXIgd3JhcHBlciBpbmhlcml0IHN0YXRpYyBwcm9wcyBmcm9tIHRoZSB3cmFwcGluZyBtZXRob2QsXG4gICAgLy8gYW5kIHRoZSB3cmFwcGluZyBtZXRob2QsIHByb3BzIGZyb20gdGhlIG9yaWdpbmFsIG1ldGhvZFxuICAgIGlmIChvcmlnaW5hbClcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGN1cnJlbnQsIG9yaWdpbmFsKTtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yod3JhcHBlciwgY3VycmVudCk7XG4gICAgb2JqW21ldGhvZF0gPSB3cmFwcGVyO1xuICAgIC8vIFJldHVybiBhIGNhbGxiYWNrIHRvIGFsbG93IHNhZmUgcmVtb3ZhbFxuICAgIHJldHVybiByZW1vdmU7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYmVlbiBkZWFjdGl2YXRlZCBhbmQgYXJlIG5vIGxvbmdlciB3cmFwcGVkLCByZW1vdmUgb3Vyc2VsdmVzXG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbCAmJiBvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcilcbiAgICAgICAgICAgIHJlbW92ZSgpO1xuICAgICAgICByZXR1cm4gY3VycmVudC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gcmVtb3ZlKCkge1xuICAgICAgICAvLyBJZiBubyBvdGhlciBwYXRjaGVzLCBqdXN0IGRvIGEgZGlyZWN0IHJlbW92YWxcbiAgICAgICAgaWYgKG9ialttZXRob2RdID09PSB3cmFwcGVyKSB7XG4gICAgICAgICAgICBpZiAoaGFkT3duKVxuICAgICAgICAgICAgICAgIG9ialttZXRob2RdID0gb3JpZ2luYWw7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGVsZXRlIG9ialttZXRob2RdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50ID09PSBvcmlnaW5hbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgLy8gRWxzZSBwYXNzIGZ1dHVyZSBjYWxscyB0aHJvdWdoLCBhbmQgcmVtb3ZlIHdyYXBwZXIgZnJvbSB0aGUgcHJvdG90eXBlIGNoYWluXG4gICAgICAgIGN1cnJlbnQgPSBvcmlnaW5hbDtcbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIG9yaWdpbmFsIHx8IEZ1bmN0aW9uKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZGVkdXBlKGtleSwgb2xkRm4sIG5ld0ZuKSB7XG4gICAgY2hlY2tba2V5XSA9IGtleTtcbiAgICByZXR1cm4gY2hlY2s7XG4gICAgZnVuY3Rpb24gY2hlY2soLi4uYXJncykge1xuICAgICAgICByZXR1cm4gKG9sZEZuW2tleV0gPT09IGtleSA/IG9sZEZuIDogbmV3Rm4pLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbn1cbmV4cG9ydCBmdW5jdGlvbiBhZnRlcihwcm9taXNlLCBjYikge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW4oY2IsIGNiKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemUoYXN5bmNGdW5jdGlvbikge1xuICAgIGxldCBsYXN0UnVuID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgZnVuY3Rpb24gd3JhcHBlciguLi5hcmdzKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7XG4gICAgICAgICAgICBhZnRlcihsYXN0UnVuLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXN5bmNGdW5jdGlvbi5hcHBseSh0aGlzLCBhcmdzKS50aGVuKHJlcywgcmVqKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgd3JhcHBlci5hZnRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGxhc3RSdW4gPSBuZXcgUHJvbWlzZSgocmVzLCByZWopID0+IHsgYWZ0ZXIobGFzdFJ1biwgcmVzKTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gd3JhcHBlcjtcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx1QkFhTzs7O0FDVFAsc0JBZU87QUFXUCxJQUFNLFdBQVcsb0JBQUksUUFBK0I7QUFHN0MseUJBQXlCLE1BQXFCO0FBRWpELFNBQU8sS0FBSyxZ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
